!function(t,e){"use strict";var o="eFit",i=e.module(o,["ngSanitize","ngMessages","ngResource","ui.router","eFit.views","eFit.config"]);i.config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider","$templateRequestProvider","$resourceProvider","$qProvider","VIEWS_PATH",function(t,o,i,n,s,r,a,c){t.html5Mode(!1),t.hashPrefix("!"),n.interceptors.push("httpInterceptor"),a.errorOnUnhandledRejections(!1),r.defaults.actions={get:{method:"GET"},list:{method:"GET",isArray:!0},update:{method:"PATCH"},create:{method:"POST"},"delete":{method:"DELETE"}},o.decorator("views",function(t,o){var i={},n=o(t);return e.forEach(n,function(e,o){var n=o.match(/([^@]+)\@/),s=n?"/"+n[1]:"",r=t.name.replace(/\./g,"/"),a=e.templateUrl||[c,r,s,".html"].join("");e.templateUrl=a,i[o]=e}),i}),s.httpOptions({skipAuthorization:!0}),o.state("main",{url:"","abstract":!0,resolve:{translations:["i18n",function(t){return t.load("de",{skipAuthorization:!0})}]},template:'<div id="main" data-ui-view=""></div>'}),o.state("frontend",{parent:"main",url:"/",resolve:{current:["user","$state","$timeout",function(t,e,o){var i=t.load().$promise;return i["catch"](function(){o(function(){e.go("login.frontend")})})}]},data:{role:["ROLE_USER","ROLE_ADMIN","ROLE_SUPER_ADMIN"]},views:{"navbar@frontend":{},"home@frontend":{},"topics@frontend":{},"financial-knowledge@frontend":{},"financial-knowledge/interest-task@frontend":{},"financial-knowledge/diversification-task@frontend":{},"consumer-behaviour@frontend":{},"consumer-behaviour/bomb-task@frontend":{},"consumer-behaviour/anchoring-task@frontend":{},"consumer-behaviour/mental-bookkeeping-task@frontend":{},"consumer-behaviour/framing-task@frontend":{},"self-control@frontend":{},"self-control/savings-target-task@frontend":{},"self-control/savings-supported-task@frontend":{},"self-control/self-commitment-task@frontend":{},"self-control/procrastination-task@frontend":{},"status@frontend":{},"contact@frontend":{controller:"ContactController",controllerAs:"contactController"},"footer@frontend":{},"offcanvas@":{controller:"FrontendController",controllerAs:"frontendController"},"@":{controller:"FrontendController",controllerAs:"frontendController"}}}),o.state("backend",{parent:"main",url:"/admin",data:{role:["ROLE_ADMIN","ROLE_SUPER_ADMIN"]},resolve:{isSuperAdmin:["auth","$state","$q",function(t,e,o){var i=o.defer(),n=function(){i.resolve(!0)},s=function(){i.resolve(!1)};return t.hasRole("ROLE_SUPER_ADMIN").then(n,s),i.promise}]},redirectTo:"backend.workshops",views:{"main@backend":{},"navbar@backend":{},"footer@backend":{},"offcanvas@":{controller:"BackendController",controllerAs:"backendController"},"@":{controller:"BackendController",controllerAs:"backendController"}}}),o.state("backend.workshops",{url:"?{expand:int}",data:{role:["ROLE_ADMIN","ROLE_SUPER_ADMIN"]},resolve:{workshops:["Workshop",function(t){return t.list().$promise}]},params:{expand:{value:null,dynamic:!0}},controller:"WorkshopController",controllerAs:"workshopController"}),o.state("backend.admins",{url:"/trainer",data:{role:"ROLE_SUPER_ADMIN",redirects:{ROLE_ADMIN:"backend"}},resolve:{admins:["Admin",function(t){return t.list().$promise}]},controller:"AdminController",controllerAs:"adminController"}),o.state("login",{url:"/login",parent:"main","abstract":!0,redirectTo:"login.frontend.index"}),o.state("login.frontend",{url:"/app",resolve:{code:["CODE_STORAGE_KEY","storage",function(t,e){var o=e.getProxy();return o.getItem(t)}]},data:{redirects:{ROLE_USER:"frontend"}},redirectTo:"login.frontend.index",controller:"LoginFrontendController",controllerAs:"loginFrontendController"}),o.state("login.frontend.index",{url:""}),o.state("login.frontend.signup",{url:"/schule",redirectTo:"login.frontend.signup.step1"}),o.state("login.frontend.signup.step1",{url:"/schritt-1",redirectTo:function(t){var e=function(t){if(t)return"login.frontend.signup.step2"},o=t.injector(),i=o.getAsync("code");return i.then(e)}}),o.state("login.frontend.signup.step2",{url:"/schritt-2",resolvePolicy:{when:"EAGER"},redirectTo:function(t){var e=function(t){if(!t)return"login.frontend.signup.step1"},o=t.injector(),i=o.getAsync("code");return i.then(e)}}),o.state("login.frontend.signin",{url:"/zuhause"}),o.state("login.backend",{url:"/admin",data:{redirects:{ROLE_ADMIN:"backend",ROLE_SUPER_ADMIN:"backend"}},controller:"LoginBackendController",controllerAs:"loginBackendController"}),i.otherwise("/")}]),i.run(["$injector",function(t){var o=t.get("$transitions"),i=t.get("$rootScope"),n=t.get("appState"),s=t.get("$state"),r=t.get("auth"),a=r.getUser(),c=function(t){n.routerBusy=!0;var o=t.to(),i=o.data||{},c=i.role||null,l=i.redirects||{};if(null===c){if(null===a)return!0;var u=a.roles||[];for(c in l)if(u.indexOf(c)>=0){var h=l[c];return s.target(h)}return!0}e.isArray(c)||(c=[c]);var p=function(){return!0},d=function(){switch(c[0]){case"ROLE_ADMIN":case"ROLE_SUPER_ADMIN":return s.target("login.backend");default:return s.target("login.frontend")}};return r.hasRole(c).then(p,d)},l=function(){if(n.routerBusy=!1,null!==a){var t=a.roles[0];if(a=r.getUser(),null===a)switch(t){case"ROLE_ADMIN":case"ROLE_SUPER_ADMIN":s.go("login.backend");break;default:s.go("login.frontend")}}},u=function(t){i.state=t.to(),n.routerBusy=!1};i.$watch(function(){return n.isBusy()},function(t){i.isBusy=t,i.httpBusy=n.httpBusy,i.routerBusy=n.routerBusy}),o.onError({},l),o.onStart({},c),o.onSuccess({},u)}]),t.ANGULAR_MODULE=o}(window,angular),function(t,e){"use strict";var o=function(t){this.$injector=t,this._urls={}};o.$inject=["$injector"],o.prototype.getLastSuccessResponse=function(){return this._lastSuccessResponse},o.prototype.getLastErrorResponse=function(){return this._lastErrorResponse},o.prototype.getLastResponse=function(){return this._lastResponse},o.prototype.getUrls=function(){return this._urls},o.prototype.request=function(t){var e=this.$injector.get("appState");e.httpBusy=!0,this._setUrl(t),t.headers["X-Requested-With"]="XMLHttpRequest";var o=function(e){return e&&(t.headers.Authorization="Bearer "+e),t},i=function(){return t};if(t.skipAuthorization)return t;var n=this._getJWTToken(t),s=this.$injector.get("$q");return s.when(n).then(o,i)},o.prototype.requestError=function(t){var e=this.$injector.get("appState"),o=this.$injector.get("$q");return e.httpBusy=!1,o.reject(t)},o.prototype.response=function(t){var e=this.$injector.get("appState");return this._setLastSuccessResponse(t),this._setLastResponse(t),e.httpBusy=!1,t},o.prototype.responseError=function(t){var e=this.$injector.get("appState"),o=this.$injector.get("$q");return this._showGlobalErrorMessage(t),this._setLastErrorResponse(t),this._setLastResponse(t),this._checkJWT(t),e.httpBusy=!1,o.reject(t)},o.prototype._setUrl=function(t){var e=this.$injector.get("$httpParamSerializer"),o=e(t.params),i=t.url+(o?"?"+o:"");this._urls[i]=!0},o.prototype._setLastResponse=function(t){this._lastResponse=t},o.prototype._setLastErrorResponse=function(t){this._lastErrorResponse=t},o.prototype._setLastSuccessResponse=function(t){this._lastSuccessResponse=t},o.prototype._showGlobalErrorMessage=function(t){var e=this.$injector.get("notification"),o=this.$injector.get("i18n"),i=t.config||{};if(!i.skipGlobalErrorMessage){var n=t.data||{};n.message&&e.error(o.get(n.message))}},o.prototype._checkJWT=function(t){var e=this.$injector.get("jwt");switch(t.status){case 403:e.invalidate()}},o.prototype._getJWTToken=function(){var t=this.$injector.get("auth"),e=this.$injector.get("jwt"),o=e.getToken();if(!o)return null;if(e.isExpired(o,600)){var i=function(){return e.getToken()},n=function(){return null};return t.refresh().then(i,n)}return e.getToken()},e.module(t).factory("httpInterceptor",["$injector",function(t){var e=t.instantiate(o);return{getUrls:function(){return e.getUrls()},getLastResponse:function(){return e.getLastResponse()},getLastErrorResponse:function(){return e.getLastErrorResponse()},getLastSuccessResponse:function(){return e.getLastSuccessResponse()},request:function(t){return e.request(t)},response:function(t){return e.response(t)},requestError:function(t){return e.responseError(t)},responseError:function(t){return e.responseError(t)}}}])}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(){};o.$inject=[],o.prototype.notify=function(t,e,o){return e=e||"default",o=o||{},o.message=t,o.status=e,UIkit.notification(o)},o.prototype.success=function(t,e){this.notify(t,"success",e)},o.prototype.primary=function(t,e){this.notify(t,"primary",e)},o.prototype.error=function(t,e){this.notify(t,"danger",e)},o.prototype.warning=function(t,e){this.notify(t,"warning",e)},o.prototype.closeAll=function(){UIkit.notification.closeAll()},e.module(t).service("notification",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t){this.$injector=t};o.$inject=["$injector"],o.prototype.httpBusy=!1,o.prototype.routerBusy=!1,o.prototype.isBusy=function(){return this.httpBusy||this.routeBusy},e.module(t).service("appState",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t){this.$injector=t};o.$inject=["$injector"],o.prototype.animationEndEvent=function(){var t=document.createElement("div"),e={WebkitAnimation:"webkitAnimationEnd",MozTAnimation:"animationend",animation:"animationend"};for(var o in e){var i=t.style[o];if(void 0!==i)return e[o]}return null}(),o.prototype.transitionEndEvent=function(){var t=document.createElement("div"),e={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var o in e){var i=t.style[o];if(void 0!==i)return e[o]}return null}(),o.prototype.translate=function(t,o,i){var n=this.$injector.get("string"),s=e.isUndefined(i)?n.sprintf("translate(%spx,%spx)",t,o):n.sprintf("translate3d(%spx,%spx,%spx)",t,o,i);return{webkitTransform:s,mozTransform:s,msTransform:s,oTransform:s,transform:s}},o.prototype.requestAnimationFrame=function(){for(var t=0,e=["ms","moz","webkit","o"],o=0;o<e.length&&!window.requestAnimationFrame;o++)window.requestAnimationFrame=window[e[o]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[o]+"CancelAnimationFrame"]||window[e[o]+"CancelRequestAnimationFrame"];return window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var o=(new Date).getTime(),i=Math.max(0,16-(o-t)),n=function(){e(o+i)},s=window.setTimeout(n,i);return t=o+i,s}),window.requestAnimationFrame.bind(window)}(),o.prototype.cancelAnimationFrame=function(){return window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)}),window.cancelAnimationFrame.bind(window)}(),e.module(t).service("animation",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(){this._spareRandomCache=null};o.$inject=[],o.prototype.between=function(t,e){t="undefined"!=typeof t?t:0,e="undefined"!=typeof e?e:1;var o=e-t+1,i=Math.random();return Math.floor(i*o+t)},o.prototype.gaussian=function(t,e){e="undefined"!=typeof e?e:1,t="undefined"!=typeof t?t:0;var o=this._spareRandomCache;if(null!==this._spareRandomCache)return this._spareRandomCache=null,t+e*o;var i,n,s;do i=2*Math.random()-1,n=2*Math.random()-1,s=i*i+n*n;while(s>=1||0===s);var r=Math.sqrt(-2*Math.log(s)/s);return this._spareRandomCache=n*r,t+e*i*r},o.prototype.pick=function(t){return t[this.between(0,t.length-1)]},o.prototype.push=function(t,e){var o=this.between(0,t.length-1);return t.push(t[o]),t[o]=e,t.length},o.prototype.shuffle=function(t){for(var e=t.length-1;e>0;e--){var o=this.between(0,e),i=t[e];t[e]=t[o],t[o]=i}return t},e.module(t).service("random",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(){};o.$inject=[],o.prototype.sprintf=function(t,o){e.isArray(o)||(o=[].slice.call(arguments,1));for(var i=0;i<o.length;i++)t=t.replace(/%s/,o[i]);return t},o.prototype.truncate=function(t,e){return e=e||20,t.length<=e?t:t.substring(0,e)+"..."},o.prototype.trim=function(t){return t.replace(/^\s+|\s+$/g,"")},o.prototype.toCamel=function(t){return t.replace(/([-_][a-z])/g,function(t){return t.toUpperCase().replace(/[-_]/,"")})},o.prototype.toSpinal=function(t){return t.replace(/([A-Z]|_[a-z])/g,function(t){return"-"+t.toLowerCase().replace(/_/,"")})},o.prototype.toSnake=function(t){return t.replace(/([A-Z]|-[a-z])/g,function(t){return"_"+t.toLowerCase().replace(/-/,"")})},e.module(t).service("string",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t){this.$injector=t};o.MODE_COOKIES="COOKIES",o.MODE_STORAGE="STORAGE",o.$inject=["$injector"],o.prototype.getProxy=function(t){switch(t){case o.MODE_COOKIES:return this._getCookieProxy();case o.MODE_STORAGE:return this._getLocalStorageProxy();default:return this.supportsLocalStorage()?this._getLocalStorageProxy():this._getCookieProxy()}},o.prototype.supportsLocalStorage=function(){var t=this.$injector.get("$window"),e=t.localStorage,o="__local__storage__feature__test",i="__local__storage__feature__test";try{e.setItem(o,i),e.removeItem(o)}catch(n){return!1}return!0},o.prototype._encode=function(t){try{t=JSON.stringify(t)}catch(e){t=void 0}return encodeURIComponent(t)},o.prototype._decode=function(t){var e;switch(typeof t){case"string":e=decodeURIComponent(t);try{e=JSON.parse(e)}catch(o){}break;default:e=void 0}return"undefined"===e&&(e=void 0),void 0===e&&(e=null),e},o.prototype._getCookieProxy=function(){var t=this.$injector.get("$document"),e=this,o=function(o){var i={},n=t.cookie.split("; ");if(1===n.length&&""===n[0])return i;for(var s=0;s<n.length;s++){var r=n[s].split("=");o?i[r[0]]=e._decode(r[1]):i[r[0]]=r[1]}return i},i=function(o,i,n,s,r,a){i=e._encode(i);try{var c=new Date(n);if(isNaN(c)){var l=n;throw n=void 0,new Error('storage.js: "'+l+'" cannot be converted to date string!')}n=c.toUTCString()}catch(u){}n=!!n&&n;var h=o+"="+i;h+=n?";expires="+n:"",h+=s?";domain="+s:"",h+=r?";path="+r:"",h+=a?";secure":"",t.cookie=h},n=function(t){var i=o(!1);return i.hasOwnProperty(t)?e._decode(i[t]):null},s=function(){return o(!0)},r=function(t){i(t,"",-1)},a=function(){for(var t in s())r(t)};return{getItem:n,getAllItems:s,setItem:i,removeItem:r,removeAllItems:a}},o.prototype._getLocalStorageProxy=function(){var t=this.$injector.get("$window"),e=t.localStorage,o=this,i=function(t,i){i=o._encode(i),e.setItem(t,i)},n=function(t){var i=e.getItem(t);return o._decode(i)},s=function(){for(var t={},o=0;o<e.length;o++){var i=e.key(o);t[i]=n(i)}return t},r=function(t){e.removeItem(t)},a=function(){e.clear()};return{getItem:n,getAllItems:s,setItem:i,removeItem:r,removeAllItems:a}},e.module(t).service("storage",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t){this.$injector=t};o.$inject=["$injector"],o.prototype.signup=function(t,o,i){var n=this.$injector.get("$http");o=o||"frontend",i=i||{};var s=this,r=function(t){s._saveToken(t.data)},a=function(){},c=this._getSignupUrl(o),l=n.post(c,{_username:t.username,_password:t.password},e.extend(i||{}));return l.then(r,a),l},o.prototype.signin=function(t,o,i){var n=this.$injector.get("$http");o=o||"frontend",i=i||{};var s=this,r=function(t){s._saveToken(t.data)},a=function(){},c=this._getSigninUrl(o),l=n.post(c,{_username:t.username,_password:t.password},e.extend(i||{},{skipAuthorization:!0}));return l.then(r,a),l},o.prototype.signout=function(t){var e=this.$injector.get("$http"),o=this.$injector.get("user"),i=this.$injector.get("jwt"),n=function(){o.unload(),i.invalidate()},s=function(){};return e.get(this._getSignoutUrl(),t||{}).then(n,s)},o.prototype.refresh=function(t){var o=this.$injector.get("$http"),i=this.$injector.get("jwt"),n=this,s=function(t){n._saveToken(t.data)},r=function(){},a=o.post(this._getRefereshUrl(),{refresh_token:i.getRefreshToken()},e.extend(t||{},{skipGlobalErrorMessage:!0,skipAuthorization:!0}));return a.then(s,r),a},o.prototype.getUser=function(t){t=t||!1;var e=this.$injector.get("jwt"),o=e.getToken();return o?!t&&e.isExpired()?null:e.decode(o):null},o.prototype.hasRole=function(t){var o=this.$injector.get("jwt"),i=this.$injector.get("$q"),n=i.defer(),s=n.promise,r=e.isArray(t);if(r&&0===t.length)return n.reject(null),s;if(!t)return n.reject(null),s;var a=this.getUser(!0);if(null===a)return n.reject(null),s;var c=function(o){var i=o.roles||[];e.isString(t)&&(t=[t]);for(var s=!1,r=0;r<t.length;r++)if(i.indexOf(t[r])>=0){s=!0;break}s?n.resolve():n.reject()};if(!o.isExpired())return c(a),s;var l=this,u=function(){a=l.getUser(),c(a)},h=function(){n.reject()};return this.refresh().then(u,h),s},o.prototype._saveToken=function(t){var e=this.$injector.get("jwt");e.setRefreshToken(t.refresh_token),e.setToken(t.token)},o.prototype._getSigninUrl=function(t){var e=this.$injector.get("API_URL");switch(t){case"backend":case"frontend":return e+"/auth/"+t+"/signin";default:throw new Error("Unknown firewall name: "+t)}},o.prototype._getSignupUrl=function(t){var e=this.$injector.get("API_URL");switch(t){case"frontend":return e+"/auth/"+t+"/signup";case"backend":throw new Error("Not implemented yet!");default:throw new Error("Unknown firewall name: "+t)}},o.prototype._getRefereshUrl=function(){var t=this.$injector.get("API_URL");return t+"/auth/refresh"},o.prototype._getSignoutUrl=function(){var t=this.$injector.get("API_URL");return t+"/signout"},e.module(t).service("auth",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t){this.translations={},this.$injector=t,this.setLocale(this._detectLocale())};o.$inject=["$injector"],o.prototype.locales={de:!0},o.prototype.defaultLocale="de",o.prototype.load=function(t,e){if(t=t||this.getLocale(),e=e||{},!this.translations[t]){var o=this.$injector.get("$http"),i=this.$injector.get("$log"),n=this,s=this._getJSONUrl(t),r=function(e){n.translations[t]=e.data},a=function(){i.error("Could not load translations!")};return o.get(s,e).then(r,a)}},o.prototype.setLocale=function(t){return this.locales[t]?void(this.locale=t):void(this.locale=this.defaultLocale)},o.prototype.getLocale=function(){return this.locale},o.prototype.get=function(t){var e,o=this.$injector.get("string"),i=[].slice.call(arguments,1),n=this.getLocale();try{e=this.translations[n][t]}catch(s){}return o.sprintf(e||t,i)},o.prototype._getJSONUrl=function(t){return"json/"+t+".json"},o.prototype._detectLocale=function(){var t,e=this.$injector.get("$window").navigator,o=/android.*\W(\w\w)-(\w\w)\W/i;return e&&e.userAgent&&(t=e.userAgent.match(o))&&(t=t[1]),!t&&e&&(e.language?t=e.language:e.userLanguage?t=e.userLanguage:e.systemLanguage?t=e.systemLanguage:e.browserLanguage&&(t=e.browserLanguage)),t?t.substr(0,2):this.defaultLocale},e.module(t).service("i18n",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e){this.$injector=t,this.storage=e.getProxy()};o.$inject=["$injector","storage"],o.prototype.tokenKey="NAksNyshI3",o.prototype.refreshKey="i08BFNG9t5",o.prototype.invalidate=function(){this.removeRefreshToken(),this.removeToken()},o.prototype.getToken=function(){return this.storage.getItem(this.tokenKey)},o.prototype.setToken=function(t){this.storage.setItem(this.tokenKey,t)},o.prototype.removeToken=function(){this.storage.removeItem(this.tokenKey)},o.prototype.getRefreshToken=function(){return this.storage.getItem(this.refreshKey)},o.prototype.setRefreshToken=function(t){this.storage.setItem(this.refreshKey,t)},o.prototype.removeRefreshToken=function(){this.storage.removeItem(this.refreshKey)},o.prototype.getExpirationDate=function(t){var e=this.$injector.get("$log");if(t=t||this.getToken(),!t)return e.error("No token given or available!"),null;var o=this.decode(t);if("undefined"==typeof o.exp)return e.error("No `exp` property available!"),null;var i=new Date(0);return i.setUTCSeconds(o.exp),i},o.prototype.isExpired=function(t,e){e=e||0,t=t||this.getToken();var o=this.getExpirationDate(t);if(null===o)return!0;var i=(new Date).valueOf();return e=i+1e3*e,o=o.valueOf(),o<=e},o.prototype.decode=function(t){var o=this.$injector.get("$log");try{var i=t.split(".");if(3!==i.length)throw new Error("JWT must have 3 parts!");var n=this._base64Decode(i[1]);if(!n)throw new Error("Cannot decode the token!");return e.fromJson(n)}catch(s){return o.error(s),null}},o.prototype._base64Decode=function(t){var e=this.$injector.get("$window"),o=this.$injector.get("$log"),i=t.replace(/-/g,"+").replace(/_/g,"/");try{switch(i.length%4){case 0:break;case 2:i+="==";break;case 3:i+="=";break;default:throw new Error("Illegal base64url code!")}}catch(n){return o.error(n),""}var s=e.atob(i),r=e.escape(s);return e.decodeURIComponent(r)},e.module(t).service("jwt",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t){this.$injector=t,this._states=[t.get("STATE_BEGINNER"),t.get("STATE_AMATEUR"),t.get("STATE_ADVANCED"),t.get("STATE_EXPERT")],this._eventSource=null,this._results=[],this._payload={},this._pending={},this._tasks={}};o.$inject=["$injector"],o.prototype.state=null,o.prototype.group=null,o.prototype.tickets=null,o.prototype.load=function(){var t=this.$injector.get("User"),e=this,o=function(t){e._payload=t.toJSON(),e._initTickets(),e._initState(),e._initGroup(),e.isUser()&&(e._initWatches(),e._initTasks(),e._initPending(),e._initResults(),e._initSSE())},i=function(){},n=t.current();return n.$promise.then(o,i),n},o.prototype.unload=function(){var t=this.$injector.get("sse");this._eventSource&&t.removeSource(this._eventSource),this._unwatchTickets&&this._unwatchTickets(),this._unwatchState&&this._unwatchState(),this._eventSource=null,this._results=[],this._payload={},this._pending={},this._tasks={},this.tickets=null,this.state=null,this.group=null},o.prototype.update=function(t){this._payload=t.user,this._addResult(t),this._initTickets(),this._initState(),this._initGroup()},o.prototype.isUser=function(){return this.hasRole("ROLE_USER")},o.prototype.isAdmin=function(){return this.hasRole("ROLE_ADMIN")},o.prototype.isSuperAdmin=function(){return this.hasRole("ROLE_SUPER_ADMIN")},o.prototype.isInWorkshop=function(){return!this.isUser()||this._payload.workshop.isActive},o.prototype.hasRole=function(t){e.isArray(t)||(t=[t]);for(var o=this._payload.roles||[],i=0;i<t.length;i++)if(o.indexOf(t[i])>=0)return!0;return!1},o.prototype.getTasks=function(){return this._tasks},o.prototype.getTaskByType=function(t){return this._tasks[t]||null},o.prototype.getPendingByType=function(t){return this._pending[t]||null},o.prototype.getGroupAsString=function(){var t=this.$injector.get("random");switch(this.group){case this.$injector.get("GROUP_A"):return"GROUP_A";case this.$injector.get("GROUP_B"):return"GROUP_B";default:return t.pick(["GROUP_A","GROUP_B"])}},o.prototype.getStateAsString=function(){switch(this.state){case this.$injector.get("STATE_AMATEUR"):return"STATE_AMATEUR";case this.$injector.get("STATE_ADVANCED"):return"STATE_ADVANCED";case this.$injector.get("STATE_EXPERT"):return"STATE_EXPERT";default:return"STATE_BEGINNER"}},o.prototype._initState=function(){var t=this.$injector.get("STATE_BEGINNER");this.state=this._payload.state||t},o.prototype._initGroup=function(){this.group=this._payload.group||null},o.prototype._initTickets=function(){var t=this._payload.tickets;this.tickets=t||[]},o.prototype._initWatches=function(){var t=this.$injector.get("notification"),e=this.$injector.get("$rootScope"),o=this.$injector.get("i18n"),i=this,n=function(){return i.state},s=function(e,n){e!==n&&t.success(o.get("Congratulations, you have reached the state %s!",o.get(i.getStateAsString())))},r=function(){return i.tickets.length},a=function(e,i){if(e!==i){var n=e-i;if(!(n<=0)){var s=1===n?o.get("Congratulations, you have earned 1 new ticket!"):o.get("Congratulations, you have earned %s new tickets!",n);t.primary(s)}}};this._unwatchTickets=e.$watch(r,a),this._unwatchState=e.$watch(n,s)},o.prototype._initSSE=function(){var t=this.$injector.get("$rootScope"),o=this.$injector.get("API_URL"),i=this.$injector.get("sse"),n=this._payload.workshop;if(n.isActive){var s=this,r=function(o){t.$evalAsync(function(){e.forEach(o,function(t){var e=Date.parse(t.updatedAt),o=s._tasks[t.type];o.isActive=!!t.isActive,isNaN(e)||(t.updatedAt=e)})})},a=o+"/sse/workshop/"+n.id+"/tasks",c={onMessage:r,sleep:1};this._eventSource=i.addSource(a,c)}},o.prototype._initTasks=function(){var t=this._payload.workshop;if(t){var o=this;e.forEach(t.tasks,function(t){o._tasks[t.type]=t})}},o.prototype._initPending=function(){var t=this._payload.pending;if(t){var o=this;e.forEach(t,function(t){o._pending[t.task.type]=t})}},o.prototype._initResults=function(){var t=this._addResult.bind(this),o=this._payload.results||[];e.forEach(o,t)},o.prototype._addResult=function(t){var e=this.getTaskByType(t.task.type);if(null!==e){var o=e.$$results||0;e.$$results=o+1}this._results.push(t)},e.module(t).service("user",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t){this.$injector=t};o.$inject=["$injector"],o.prototype.send=function(t,e){var o=this.$injector.get("notification"),i=this.$injector.get("$http"),n=this.$injector.get("i18n"),s=function(){o.success(n.get("Your email has been sent!"))},r=function(){},a=i.post(this._getPostUrl(),{_name:t.name,_mail:t.email,_subject:t.subject,_message:t.message},e||{});return a.then(s,r),a},o.prototype._getPostUrl=function(){var t=this.$injector.get("API_URL");return t+"/mail"},e.module(t).service("mail",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t){this.$injector=t,this._sources={}};o.$inject=["$injector"],o.prototype.addSource=function(t,o){o=o||{},o.retry=o.retry||null,o.event=o.event||null,o.sleep=o.sleep||null,o.onError=o.onError||function(){},o.onMessage=o.onMessage||function(){},t=this._buildUrl(t,o);var i=new EventSource(t);return i.onmessage=function(t){var i=e.fromJson(t.data);o.onMessage.call(this,i,t)},i.onerror=function(t){o.onError.call(this,t)},this._sources[t]=i,i},o.prototype.removeSource=function(t){delete this._sources[t.url],t.close()},o.prototype._buildUrl=function(t,e){var o=this.$injector.get("jwt"),i=o.getToken();return t=t+"?bearer="+i,e.event&&(t+="&event="+e.event),e.sleep&&(t+="&sleep="+e.sleep),e.retry&&(t+="&retry="+e.retry),t},e.module(t).service("sse",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(){};o.$inject=["$scope","$element","$attrs"],o.prototype.cards=[],o.prototype.canToggle=!1,o.prototype.add=function(t){this.cards.push(t)},o.prototype.set=function(t){if(t.selected&&!this.canToggle)return!1;var o=!!t.selected;return t.selected=!o||null,e.forEach(this.cards,function(e){e.id!==t.id&&(e.selected=!t.selected&&null)}),!0},e.module(t).directive("cardContainer",function(){return{scope:{canToggle:"=?cardContainerCanToggle"},restrict:"A",controller:o,bindToController:!0,controllerAs:"cardContainerController"}});var i=function(t,e,o,i){this.$scope=t,this.$attrs=o,this.$element=e,this.id=this.$scope.$id,this.hasIcon=i.isSlotFilled("icon")};i.$inject=["$scope","$element","$attrs","$transclude"],i.prototype.id=null,i.prototype.data=null,i.prototype.selected=null,i.prototype.disabled=null,i.prototype.hasIcon=null,i.prototype.isCheckbox=!1,i.prototype.$onInit=function(){this.cardContainer&&this.cardContainer.add(this)},i.prototype.click=function(t){if(!this.disabled){if(t.stopPropagation(),t.preventDefault(),this.cardContainer){var e=this.cardContainer.set(this);if(!e)return}this.onClick({data:this.data,selected:this.selected,disabled:this.disabled})}},e.module(t).directive("card",function(){return{scope:{data:"=?cardData",onClick:"&cardOnClick",selected:"=?cardSelected",disabled:"=?cardDisabled",isCheckbox:"=?cardIsCheckbox"},restrict:"A",transclude:{text:"cardText",title:"cardTitle",icon:"?cardIcon",buttons:"?cardButtons"},controller:i,bindToController:!0,controllerAs:"cardController",require:{cardContainer:"^?cardContainer"},templateUrl:"views/directives/card.html"}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i){this.$scope=t,this.$attrs=e,this.$element=o,this.$injector=i,this._chart=null};o.$inject=["$scope","$attrs","$element","$injector"],o.prototype.data=[],o.prototype.$onInit=function(){var t=this._getOptions(),e={labels:this._getLabels(),series:this._getData()};this._render(e,t)},o.prototype.$onDestroy=function(){null!==this._chart&&(this._chart.detach(),this._chart=null)},o.prototype._getData=function(){var t,o=this.$injector.get("GROUP_A"),i=this.$injector.get("GROUP_B"),n=this,s={},r=[];switch(n.task.type){case n.$injector.get("TYPE_ANCHORING"):case n.$injector.get("TYPE_MENTAL_BOOKKEEPING"):s[o]={choice1:0,choice2:0,count:0},s[i]={choice1:0,choice2:0,count:0},t=function(t){var e=t.json.group,o=t.json.choice;s[e]["choice"+o]++,s[e].count++},e.forEach(this.results,t);var a=s[o],c=s[i];r.push([a.choice1/a.count,c.choice1/c.count]),r.push([a.choice2/a.count,c.choice2/c.count]);break;case n.$injector.get("TYPE_SAVINGS_SUPPORTED"):s.count=0,s.choice1=0,s.choice2=0,s.choice3=0,s.choice4=0,t=function(t){var e=t.json.choice;s["choice"+e]++,s.count++},e.forEach(this.results,t),r.push([s.choice1/s.count,s.choice2/s.count,s.choice3/s.count,s.choice4/s.count]);break;case n.$injector.get("TYPE_PROCRASTINATION"):var l="SPLIT",u="ALL";s[l]={success:0,failure:0,count:0},s[u]={success:0,failure:0,count:0},t=function(t){var e=t.json.mode;t.json.success?s[e].success++:s[e].failure++,s[e].count++},e.forEach(this.results,t);var h=s[l],p=s[u];r.push([h.success/h.count,p.success/p.count]),r.push([h.failure/h.count,p.failure/p.count])}return r},o.prototype._getLabels=function(){var t=this.$injector.get("i18n");switch(this.task.type){case this.$injector.get("TYPE_ANCHORING"):return[t.get("WITH_ANCHOR"),t.get("WITHOUT_ANCHOR")];case this.$injector.get("TYPE_MENTAL_BOOKKEEPING"):return[t.get("MONEY_LOST"),t.get("TICKET_LOST")];case this.$injector.get("TYPE_SAVINGS_SUPPORTED"):return[t.get("REMINDER_SMS"),t.get("CHILDREN_SMS"),t.get("PREMIUM_SAVINGS"),t.get("SAVINGS_COIN")];case this.$injector.get("TYPE_PROCRASTINATION"):return[t.get("ALL"),t.get("SPLIT")];default:return[]}},o.prototype._getOptions=function(){var t=this.$injector.get("i18n"),e={seriesBarDistance:70,chartPadding:{top:50,left:0,right:0,bottom:0},axisY:{labelInterpolationFnc:function(t){return 100*t+"%"},ticks:[0,.2,.4,.6,.8,1],type:Chartist.FixedScaleAxis,high:1,low:0}};switch(this.task.type){case this.$injector.get("TYPE_ANCHORING"):case this.$injector.get("TYPE_MENTAL_BOOKKEEPING"):e.plugins=[Chartist.plugins.legend({legendNames:[t.get("BUYING"),t.get("NOT_BUYING")]})];break;case this.$injector.get("TYPE_PROCRASTINATION"):e.plugins=[Chartist.plugins.legend({legendNames:[t.get("Target reached"),t.get("Target dismissed")]})]}return e},o.prototype._render=function(t,e){var o=this.$injector.get("$timeout");this.$element.addClass("ct-chart");var i=this.$element.get(0),n=this,s=function(){switch(n.task.type){case n.$injector.get("TYPE_ANCHORING"):case n.$injector.get("TYPE_MENTAL_BOOKKEEPING"):case n.$injector.get("TYPE_SAVINGS_SUPPORTED"):case n.$injector.get("TYPE_PROCRASTINATION"):n._chart=new Chartist.Bar(i,t,e)}};o(s,100)},e.module(t).directive("chart",function(){return{scope:{task:"=?chartTask",results:"=?chartResults"},restrict:"A",controller:o,bindToController:!0,controllerAs:"chartController"}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i){this.$scope=t,this.$attrs=e,this.$element=o,this.$transclude=i,this._element=null,this._modal=null,this._scope=null};o.$inject=["$scope","$attrs","$element","$transclude"],o.prototype.isVisible=!1,o.prototype.$onInit=function(){var t=this;this._onShow=function(){t.$scope.$evalAsync(t.onShow)},this._onShown=function(){t.$scope.$evalAsync(t.onShown)},this._onBeforeShow=function(){t.$scope.$evalAsync(t.onBeforeShow)},this._onHide=function(){t.$scope.$evalAsync(t.onHide)},this._onHidden=function(){t.$scope.$evalAsync(function(){t.onHidden(),t.isVisible=!1})},this._onBeforeHide=function(){t.$scope.$evalAsync(t.onBeforeHide)},this._unwatch=this.$scope.$watch("modalController.isVisible",function(e){return e?void t.transclude():void t.destroy()})},o.prototype.$onDestroy=function(){this._unwatch(),this.destroy()},o.prototype.transclude=function(){
var t=this,e=function(e,o){t._element=e,t._scope=o,t._element.on("show",t._onShow),t._element.on("shown",t._onShown),t._element.on("beforeshow",t._onBeforeShow),t._element.on("hide",t._onHide),t._element.on("hidden",t._onHidden),t._element.on("beforehide",t._onBeforeHide),t.$element.append(e),t._modal=UIkit.modal(e),t._modal.show()};this.$transclude(e)},o.prototype.destroy=function(){null!==this._element&&(this._element.off("show",this._onShow),this._element.off("shown",this._onShown),this._element.off("beforeshow",this._onBeforeShow),this._element.off("hide",this._onHide),this._element.off("hidden",this._onHidden),this._element.off("beforeHide",this._onBeforeHide),this._element.remove(),this._element=null),null!==this._scope&&(this._scope.$destroy(),this._scope=null),null!==this._modal&&(this._modal.hide(),this._modal=null)},e.module(t).directive("modal",function(){return{scope:{isVisible:"=?modal",onShow:"&modalOnShow",onHide:"&modalOnHide",onShown:"&modalOnShown",onHidden:"&modalOnHidden",onBeforeShow:"&modalOnBeforeShow",onBeforeHide:"&modalOnBeforeHide"},restrict:"A",controller:o,transclude:"element",bindToController:!0,controllerAs:"modalController"}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i){this.$scope=t,this.$attrs=o,this.$element=e,this.$injector=i,this._player=null,this._element=this.$element.find(".player"),this._onReady=this._onReady.bind(this),this._onStateChange=this._onStateChange.bind(this)};o.$inject=["$scope","$element","$attrs","$injector"],o.prototype.width=640,o.prototype.height=360,o.prototype.videoId=null,o.prototype.$onInit=function(){var t=this.$injector.get("$window"),e=this,o=function(){return t.YOUTUBE_API_LOADED},i=function(t){t&&(e._unwatchAPI(),e._onReady())};this._unwatchAPI=this.$scope.$watch(o,i)},o.prototype.$onDestroy=function(){this._player&&this._player.destroy()},o.prototype.getStyle=function(){return{"padding-bottom":this.height/this.width*100+"%"}},o.prototype._onReady=function(){var t=this._element.get(0);this._player=new YT.Player(t,{width:this.width,height:this.height,videoId:this.videoId,events:{onStateChange:this._onStateChange}})},o.prototype._onStateChange=function(t){switch(t.data){case YT.PlayerState.PLAYING:this.onPlaying();break;case YT.PlayerState.PAUSED:this.onPaused();break;case YT.PlayerState.ENDED:this.onEnded();break;case YT.PlayerState.CUED:this.onCued()}},e.module(t).directive("video",function(){return{scope:{videoId:"=videoId",width:"=?videoWidth",height:"=?videoHeight",onCued:"&videoOnCued",onEnded:"&videoOnEnded",onPaused:"&videoOnPaused",onPlaying:"&videoOnPlaying",onBuffering:"&videoOnBuffering"},restrict:"A",transclude:!0,controller:o,bindToController:!0,controllerAs:"videoController",templateUrl:"views/directives/video.html"}})}(ANGULAR_MODULE,angular,this),function(t,e){"use strict";var o=function(t,e,o,i){this.$scope=t,this.$attrs=o,this.$element=e,this.$injector=i,this.iconRatio=1,this.isCompact=!1,this.iconColor="currentcolor"};o.$inject=["$scope","$element","$attrs","$injector"],o.prototype.tasks={},o.prototype.tickets=[],o.prototype.tasksVisible=!1,o.prototype.ticketsVisible=!1,o.prototype.$onInit=function(){var t=this.$injector.get("user"),e=this,o=function(){return t.tickets},i=function(t){e.tickets=t};this._unwatchTickets=this.$scope.$watchCollection(o,i);var n=function(){return t.getTasks()},s=function(t){e.tasks=t};this._unwatchTasks=this.$scope.$watch(n,s)},o.prototype.$onDestroy=function(){this._unwatchTickets(),this._unwatchTasks()},o.prototype.toggleTasks=function(){this.tasksVisible=!this.tasksVisible},o.prototype.toggleTickets=function(){this.ticketsVisible=!this.ticketsVisible},e.module(t).directive("status",function(){return{scope:{iconRatio:"=?statusIconRatio",iconColor:"=?statusIconColor",isCompact:"=?statusIsCompact"},restrict:"A",transclude:!0,controller:o,bindToController:!0,controllerAs:"statusController",templateUrl:"views/directives/status.html"}});var i=function(t,e,o,i){this.$scope=t,this.$attrs=e,this.$element=o,this.$injector=i,this.ratio=1,this.color="currentcolor"};i.$inject=["$scope","$attrs","$element","$injector"],i.prototype.isBeginner=!1,i.prototype.isAmateuer=!1,i.prototype.isAdvanced=!1,i.prototype.isExpert=!1,i.prototype.isProfi=!1,i.prototype.$onInit=function(){var t=this.$injector.get("STATE_BEGINNER"),e=this.$injector.get("STATE_AMATEUR"),o=this.$injector.get("STATE_ADVANCED"),i=this.$injector.get("STATE_EXPERT"),n=this.$injector.get("user"),s=this,r=function(){return n.state},a=function(n){s.isBeginner=n>=t,s.isAmateur=n>=e,s.isAdvanced=n>=o,s.isExpert=n>=i};this._unwatch=this.$scope.$watch(r,a)},i.prototype.$onDestroy=function(){this._unwatch()},e.module(t).directive("statusIcons",function(){return{scope:{ratio:"=?statusIconsRatio",color:"=?statusIconsColor"},restrict:"A",transclude:!0,controller:i,bindToController:!0,controllerAs:"statusIconsController",templateUrl:"views/directives/status-icons.html"}});var n=function(t,e,o,i){this.$scope=t,this.$attrs=e,this.$element=o,this.$injector=i};n.$inject=["$scope","$attrs","$element","$injector"],n.prototype.state=null,n.prototype.isCompact=!1,n.prototype.$onInit=function(){var t=this.$injector.get("user"),e=this,o=function(){return t.state},i=function(){e.state=t.getStateAsString()};this._unwatch=this.$scope.$watch(o,i)},n.prototype.$onDestroy=function(){this._unwatch()},e.module(t).directive("statusLabel",function(){return{scope:{isCompact:"=?statusLabelIsCompact"},restrict:"A",transclude:!0,controller:n,bindToController:!0,controllerAs:"statusLabelController",templateUrl:"views/directives/status-label.html"}});var s=function(t,e,o,i){this.$scope=t,this.$attrs=e,this.$element=o,this.$injector=i};s.$inject=["$scope","$attrs","$element","$injector"],s.prototype.tickets=0,s.prototype.isCompact=!1,s.prototype.$onInit=function(){var t=this.$injector.get("user"),e=this,o=function(){return t.tickets},i=function(t){e.tickets=t?t.length:0};this._unwatch=this.$scope.$watchCollection(o,i)},s.prototype.$onDestroy=function(){this._unwatch()},e.module(t).directive("statusTickets",function(){return{scope:{isCompact:"=?statusTicketsIsCompact"},restrict:"A",transclude:!0,controller:s,bindToController:!0,controllerAs:"statusTicketsController",templateUrl:"views/directives/status-tickets.html"}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i){this.$scope=t,this.$attrs=o,this.$element=e,this.$transclude=i,this.domId="tabber-"+t.$id,this.hasExercise=i.isSlotFilled("exercise")};o.$inject=["$scope","$element","$attrs","$transclude"],o.prototype.hasExercise=!1,o.prototype.activeTab="DESCRIPTION",o.prototype.setActive=function(t){switch(t){case"DESCRIPTION":case"EXERCISE":this.activeTab=t}},e.module(t).directive("tabber",function(){return{scope:{icon:"=?tabberIcon",activeTab:"=?tabberActiveTab"},restrict:"A",transclude:{exercise:"?tabberExercise",description:"tabberDescription"},controller:o,bindToController:!0,controllerAs:"tabberController",templateUrl:"views/directives/tabber.html"}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i){this.$element=e,this.$scope=t,this.$attrs=o,this.$injector=i,this._body=null,this._clone=null,this._coordinates={},this._interactable=null,this._activeClass="active",this._itemClass="draggable",this._disabledClass="disabled";var n=this;this._unwatch=t.$watch(function(){return n.disabled},function(t){t?n.$element.addClass(n._disabledClass):n.$element.removeClass(n._disabledClass),n._interactable.draggable({enabled:!t})}),this._onResize=this._onResize.bind(this)};o.$inject=["$scope","$element","$attrs","$injector"],o.prototype.data=null,o.prototype.clone=!1,o.prototype.disabled=!1,o.prototype.restriction="parent",o.prototype.$onInit=function(){var t=this.$injector.get("$window");this._body=e.element(document.body),this.$element.addClass(this._itemClass);var o=this.$element.get(0);this._interactable=interact(o);var i=this,n={inertia:!0,autoScroll:!0,enabled:!this.disabled,onend:this._onEndItem.bind(this),onmove:this._onMoveItem.bind(this),onstart:this._onStartItem.bind(this),snap:{targets:[function(t,e,o){if(i._origin||(i._origin={x:o.startCoords.page.x,y:o.startCoords.page.y}),!o.dropTarget)return{x:i._origin.x,y:i._origin.y}}],endOnly:!0}};this.clone&&(e.extend(n,{manualStart:!0}),this._interactable.on("move",this._onMove.bind(this))),this._interactable.draggable(n),this._interactable.getData=this._getData.bind(this),this._window=e.element(t),this._window.on("resize",this._resize)},o.prototype.$onDestroy=function(){this._window.off("resize",this._onResize),this._interactable.unset(),this._unwatch()},o.prototype._onResize=function(){this._origin=null},o.prototype._onStartItem=function(t){var o=this.clone?this._clone:e.element(t.target);o.addClass(this._activeClass),this._trigger("onDragStart",{$event:t,$data:this.data})},o.prototype._onMoveItem=function(t){var o=this.clone?this._clone:e.element(t.target),i=(this._coordinates.x||0)+t.dx,n=(this._coordinates.y||0)+t.dy;this._translate(o,i,n),this._trigger("onDragMove",{$event:t,$data:this.data})},o.prototype._onEndItem=function(t){var o=!!t.interaction.dropTarget;if(this.clone)this._coordinates={},this._clone.remove(),this._clone=null;else{var i=e.element(t.target);i.removeClass(this._activeClass),o||this._translate(i,0,0)}this._trigger("onDragEnd",{$event:t,$data:this.data}),o&&this._trigger("onDrop",{$event:t,$data:this.data})},o.prototype._onMove=function(t){var o=t.interactable,i=t.interaction,n=t.currentTarget;if(!this.disabled){if(i.pointerIsDown&&!i.interacting()){this._clone=e.element(n).clone();var s=n.clientHeight/2,r=n.clientWidth/2,a=t.touches?t.touches[0].pageY:t.pageY,c=t.touches?t.touches[0].pageX:t.pageX;this._clone.css({left:c-r+"px",top:a-s+"px",position:"absolute"}),this._body.append(this._clone),n=this._clone.get(0)}i.start({name:"drag"},o,n)}},o.prototype._getData=function(){return this.data},o.prototype._translate=function(t,e,o){var i="translate("+e+"px,"+o+"px)";t.css({webkitTransform:i,mozTransform:i,msTransform:i,oTransform:i,transform:i}),this._coordinates.x=e,this._coordinates.y=o},o.prototype._trigger=function(t,e){this.$scope.$evalAsync(this[t].bind(this,e))},e.module(t).directive("draggable",function(){return{scope:{data:"=?draggableData",clone:"=?draggableClone",disabled:"=?draggableDisabled",onDragStart:"&draggableOnDragStart",onDragMove:"&draggableOnDragMove",onDragEnd:"&draggableOnDragEnd",onDrop:"&draggableOnDrop"},restrict:"A",controller:o,bindToController:!0,controllerAs:"draggableController"}});var i=function(t,e,o){this.$element=e,this.$scope=t,this.$attrs=o,this._interactable=null,this._enterClass="enter",this._activeClass="active",this._itemClass="dropable",this._acceptClass="draggable",this._disabledClass="disabled";var i=this;this._unwatch=t.$watch(function(){return i.disabled},function(t){t?i.$element.addClass(i._disabledClass):i.$element.removeClass(i._disabledClass)})};i.$inject=["$scope","$element","$attrs"],i.prototype.disabled=!1,i.prototype.$onInit=function(){this._body=e.element(document.body),this.$element.addClass(this._itemClass);var t="."+this._acceptClass,o=this.$element.get(0);this._interactable=interact(o).dropzone({accept:t,enabled:!this.disabled,ondrop:this._onDrop.bind(this),ondragenter:this._onDragEnter.bind(this),ondragleave:this._onDragLeave.bind(this),ondropactivate:this._onDropActivate.bind(this),ondropdeactivate:this._onDropDeactivate.bind(this)})},i.prototype.$onDestroy=function(){this._interactable.unset(),this._unwatch()},i.prototype._onDropDeactivate=function(t){this.$element.removeClass(this._activeClass);var e=t.draggable.getData();this._trigger("onDropDeactivate",{$event:t,$data:e})},i.prototype._onDropActivate=function(t){this.$element.addClass(this._activeClass);var e=t.draggable.getData();this._trigger("onDropActivate",{$event:t,$data:e})},i.prototype._onDragEnter=function(t){this.$element.addClass(this._enterClass);var e=t.draggable.getData();this._trigger("onDragEnter",{$event:t,$data:e})},i.prototype._onDragLeave=function(t){this.$element.removeClass(this._enterClass);var e=t.draggable.getData();this._trigger("onDragLeave",{$event:t,$data:e})},i.prototype._onDrop=function(t){this.$element.removeClass(this._enterClass);var e=t.draggable.getData();this._trigger("onDrop",{$event:t,$data:e})},i.prototype._trigger=function(t,e){this.$scope.$evalAsync(this[t].bind(this,e))},e.module(t).directive("dropable",function(){return{scope:{disabled:"=?dropableDisabled",onDropDeactivate:"&dropableOnDropDeactivate",onDropActivate:"&dropableOnDropActivate",onDragEnter:"&dropableOnDragEnter",onDragLeave:"&dropableOnDragLeave",onDrop:"&dropableOnDrop"},restrict:"A",controller:i,bindToController:!0,controllerAs:"droppableController"}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i){this.$scope=t,this.$attrs=o,this.$element=e,this.$injector=i,this._accordion=null,this._collapsibles=[],this._init=this._init.bind(this),this._onCollapsibleClicked=this._onCollapsibleClicked.bind(this)};o.$inject=["$scope","$element","$attrs","$injector"],o.prototype.options=null,o.prototype.$onInit=function(){var t=this.$injector.get("$timeout");t(this._init,1)},o.prototype.$onDestroy=function(){this._accordion&&this._accordion.$destroy(),this._unlistenCollapsible()},o.prototype.addCollapsible=function(t){this._collapsibles.push(t)},o.prototype._init=function(){var t=this.$injector.get("$rootScope"),o=this.$element.get(0),i=e.extend({targets:".collapsible",animation:!1},this.options||{});this._unlistenCollapsible=t.$on("collapsible_clicked",this._onCollapsibleClicked),this._accordion=UIkit.accordion(o,i)},o.prototype._onCollapsibleClicked=function(t,o){var i=function(t,e){var i=o.$scope.$id,n=t.$scope.$id;i!==n&&o.open&&t.open&&(this._accordion.toggle(e),t.open=!1)};e.forEach(this._collapsibles,i.bind(this))},e.module(t).directive("accordion",function(){return{scope:{options:"=?accordionOptions"},restrict:"A",transclude:!0,controller:o,bindToController:!0,controllerAs:"accordionController",templateUrl:"views/directives/accordion.html"}});var i=function(t,e,o,i){this.$scope=t,this.$attrs=o,this.$element=e,this.$injector=i};i.$inject=["$scope","$element","$attrs","$injector"],i.prototype.id=null,i.prototype.open=!1,i.prototype.$onInit=function(){var t="collapsible-"+this.$scope.$id;this.accordion.addCollapsible(this),this.domId=this.id||t},i.prototype.onClick=function(){this.open=!this.open;var t=this.$injector.get("$rootScope");t.$broadcast("collapsible_clicked",this)},e.module(t).directive("collapsible",function(){return{scope:{id:"=?collapsible",open:"=?collapsibleOpen"},restrict:"A",transclude:{title:"?collapsibleTitle",content:"collapsibleContent"},require:{accordion:"^accordion"},controller:i,bindToController:!0,controllerAs:"collapsibleController",templateUrl:"views/directives/collapsible.html"}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i){this.$scope=t,this.$attrs=o,this.$element=e,this.$injector=i,this.options={},this._source=null,this._target=null,this._scroller=null,this._init=this._init.bind(this),this._onClick=this._onClick.bind(this),this._onScrolled=this._onScrolled.bind(this)};o.$inject=["$scope","$element","$attrs","$injector"],o.prototype.delay=null,o.prototype.options=null,o.prototype.callback=null,o.prototype.disabled=null,o.prototype.$onInit=function(){var t=this.$injector.get("$timeout");t(this._init,1)},o.prototype.$onDestroy=function(){this._source.off("scrolled",this._onScrolled),this.$element.off("click",this._onClick),this._scroller.$destroy(!0)},o.prototype._init=function(){if(this.element instanceof jQuery?this._target=this.element:e.isString(this.element)&&("#"!==this.element.charAt(0)&&(this._target="#"+this.element),this._target=jQuery(this._target)),0===this._target.length)return void console.warn("scroll-to.js: Invalid target element!");var t="#"+this._target.id;this._source=jQuery('<a href="'+t+'"></a>'),this.options=this.options||{},this.options.easing=e.isString(this.options.easing)?this.options.easing:"easeOutExpo",this.options.offset=e.isNumber(this.options.offset)?this.options.offset:100,this.options.duration=e.isNumber(this.options.duration)?this.options.duration:500,this.$element.on("click",this._onClick),this._source.on("scrolled",this._onScrolled),this._scroller=UIkit.scroll(this._source,this.options)},o.prototype._onClick=function(){var t=this.$injector.get("$timeout"),e=function(){this.disabled||this._scroller.scrollTo(this._target)};t(e.bind(this),this.delay)},o.prototype._onScrolled=function(){e.isFunction(this.callback)&&this.$scope.$evalAsync(this.callback)},e.module(t).directive("scrollTo",function(){return{scope:{element:"=scrollTo",delay:"=?scrollToDelay",options:"=?scrollToOptions",callback:"=?scrollToCallback",disabled:"=?scrollToDisabled"},restrict:"A",controller:o,bindToController:!0}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i){this.$scope=t,this.$attrs=o,this.$element=e,this.$injector=i,this.user=i.get("user"),this.domId="evaluation-"+t.$id};o.$inject=["$scope","$element","$attrs","$injector"],o.prototype.domId=null,e.module(t).directive("evaluation",function(){return{scope:{parent:"=evaluation"},restrict:"A",transclude:{text:"evaluationText",customButtons:"?evaluationCustomButtons",defaultButtons:"?evaluationDefaultButtons"},controller:o,bindToController:!0,controllerAs:"evaluationController",templateUrl:"views/directives/evaluation.html"}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i){this.$scope=t,this.$attrs=o,this.$element=e,this.user=i.get("user")};o.$inject=["$scope","$element","$attrs","$injector"],e.module(t).directive("lockedState",function(){return{scope:{isLocked:"=?lockedState"},restrict:"A",transclude:{userText:"?userText",adminText:"?adminText",superAdminText:"?superAdminText"},controller:o,bindToController:!0,controllerAs:"lockedStateController",templateUrl:"views/directives/locked-state.html"}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i,n){this.$scope=t,this.$attrs=o,this.$element=e,this.$timeout=n,this.$transclude=i,this._transcludeElements=[],this._transcludeScopes=[],this._cloneDefault=null,this._cloneLabel=null,this._unlisten=[],this._unwatch=[]};o.$inject=["$scope","$element","$attrs","$transclude","$timeout"],o.prototype.id="",o.prototype.label="",o.prototype.ngModel=null,o.prototype.resetEmpty=!0,o.prototype.showMessages=!1,o.prototype.labelClass="uk-form-label",o.prototype.failureClass="uk-form-danger",o.prototype.successClass="uk-form-success",o.prototype.$onInit=function(){this.id="form-field-"+this.$scope.$id,this._addWatches(),this._transclude()},o.prototype.$onDestroy=function(){e.forEach(this._transcludeElements,function(t){t.remove()}),e.forEach(this._transcludeScopes,function(t){t.$destroy()}),e.forEach(this._unlisten,function(t){t()}),e.forEach(this._unwatch,function(t){t()})},o.prototype.setModel=function(t){this.ngModel=t},o.prototype._update=function(){this.ngModel.$valid?(this._cloneDefault.removeClass(this.failureClass),this._cloneDefault.addClass(this.successClass)):(this._cloneDefault.removeClass(this.successClass),this._cloneDefault.addClass(this.failureClass)),this.showMessages=this.ngModel.$invalid},o.prototype._reset=function(){this._cloneDefault.removeClass(this.failureClass),this._cloneDefault.removeClass(this.successClass),this.ngModel.$setUntouched(),this.showMessages=!1},o.prototype._addWatches=function(){var t=this,e=this.$scope.$watchCollection("formFieldController.ngModel",function(e,o){if(e!==o&&e.$touched&&!e.$pending)return!e.$viewValue&&t.resetEmpty?void t._reset():void t._update()});this._unwatch.push(e)},o.prototype._transclude=function(){var t=this,o=function(o,i){var n="#default-"+t.id,s=e.element(n);o.attr("id",t.id),s.replaceWith(o),t._cloneDefault=o,t._transcludeScopes.push(i),t._transcludeElements.push(o)},i=function(o,i){var n="#label-"+t.id,s=e.element(n);o.attr("for",t.id),o.addClass(t.labelClass),s.replaceWith(o),t._cloneLabel=o,t._transcludeScopes.push(i),t._transcludeElements.push(o)},n=function(){t.$transclude(o,null,null),t.$transclude(i,null,"label")};this.$timeout(n)},e.module(ANGULAR_MODULE).directive("formField",function(){return{scope:{name:"=formField",resetEmpty:"=?formFieldResetEmpty",labelClass:"=?formFieldLabelClass",failureClass:"=?formFieldFailureClass",successClass:"=?formFieldSuccessClass"},transclude:{label:"?label",messageMin:"?messageMin",messageMax:"?messageMax",messageUrl:"?messageUrl",messageEmail:"?messageEmail",messageNumber:"?messageNumber",messagePattern:"?messagePattern",messageRequired:"?messageRequired",messageMinlength:"?messageMinlength",messageMaxlength:"?messageMaxlength",messagesCustom:"?messagesCustom"},restrict:"A",controller:o,bindToController:!0,controllerAs:"formFieldController",templateUrl:"views/directives/form-field.html"}});var i=function(t,e,o,i){this.$scope=t,this.$attrs=e,this.$element=o,this.$injector=i};i.$inject=["$scope","$attrs","$element","$injector"],i.prototype.autoFocus=!1,i.prototype.$onInit=function(){var t=this.$injector.get("$timeout"),e=this.$injector.get("$log");if(!this.formField)return void e.warn("formFieldModel: No form field controller found!");if(this.autoFocus){var o=this.$element.get(0),i=function(){o.focus()};t(i,1)}this.formField.setModel(this.ngModel)},e.module(t).directive("formFieldModel",function(){return{scope:{autoFocus:"=?formFieldModelAutoFocus"},restrict:"A",require:{ngModel:"ngModel",formField:"^?formField"},bindToController:!0,controller:i}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i){this.$scope=t,this.$attrs=e,this.$element=o,this.$injector=i,this._timer=null,this._shuffle=this._shuffle.bind(this)};o.$inject=["$scope","$attrs","$element","$injector"],o.prototype.numbers=[],o.prototype.shuffle=!0,o.prototype.finished=!1,o.prototype.value="?",o.prototype.$onInit=function(){var t=this;this._unwatch=this.$scope.$watch(function(){return t.shuffle},function(e){return e?(t.finished=!1,void t._shuffle(0)):void t._stop()})},o.prototype.$onDestroy=function(){this._unwatch(),this._stop()},o.prototype._shuffle=function(t){var e=this.$injector.get("$timeout"),o=this.numbers.length-1;return this.value=this.numbers[t],t>=o?(this.finished=!0,void this._stop()):void(this._timer=e(this._shuffle,100,!0,++t))},o.prototype._stop=function(){var t=this.$injector.get("$timeout");t.cancel(this._timer),this.shuffle=!1,this._timer=null},e.module(t).directive("randomNumber",function(){return{scope:{numbers:"=randomNumber",shuffle:"=?randomNumberShuffle",finished:"=?randomNumberFinished"},restrict:"A",transclude:!0,bindToController:!0,controller:o,controllerAs:"randomNumberController",templateUrl:"views/directives/random-number.html"}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i,n){this.$q=i,this.$scope=t,this.$attrs=o,this.$element=e,this.Workshop=n,this.keyLocked="validatorWorkshopLocked"};o.$inject=["$scope","$element","$attrs","$q","Workshop"],o.prototype.$onInit=function(){this.ngModel.$asyncValidators.validatorWorkshopExists=this.validate.bind(this)},o.prototype.validate=function(t){var e=this.$q.defer(),o=this,i=function(t){return t.isActive?(o.ngModel.$setValidity(o.keyLocked,!0),void e.resolve()):(o.ngModel.$setValidity(o.keyLocked,!1),void e.reject())},n=function(){e.reject()};return this.Workshop.validateWorkshopFrontend({code:t},i,n),e.promise},e.module(ANGULAR_MODULE).directive("validatorWorkshopExists",function(){return{restrict:"A",require:{ngModel:"ngModel"},bindToController:!0,controller:o}});var i=function(t,e,o,i,n){this.$q=i,this.$scope=t,this.$attrs=o,this.$element=e,this.Workshop=n};i.$inject=["$scope","$element","$attrs","$q","Workshop"],i.prototype.$onInit=function(){this.ngModel.$asyncValidators.validatorWorkshopUnique=this.validate.bind(this)},i.prototype.validate=function(t){var e=this.$q.defer(),o=function(){e.reject()},i=function(){e.resolve()};return this.Workshop.validateWorkshopBackend({code:t},o,i),e.promise},e.module(ANGULAR_MODULE).directive("validatorWorkshopUnique",function(){return{restrict:"A",require:{ngModel:"ngModel"},bindToController:!0,controller:i}});var n=function(t,e,o,i,n){this.$q=i,this.$scope=t,this.$attrs=o,this.$element=e,this.Admin=n};n.$inject=["$scope","$element","$attrs","$q","Admin"],n.prototype.$onInit=function(){this.ngModel.$asyncValidators.validatorAdminUnique=this.validate.bind(this)},n.prototype.validate=function(t){var e=this.$q.defer(),o=function(){e.reject()},i=function(){e.resolve()};return this.Admin.validateAdmin({username:t},o,i),e.promise},e.module(ANGULAR_MODULE).directive("validatorAdminUnique",function(){return{restrict:"A",require:{ngModel:"ngModel"},bindToController:!0,controller:n}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i){var n=i.get("TYPE_INTEREST");this.$scope=t,this.$attrs=o,this.$element=e,this.$injector=i,this.domId="interest-task-"+t.$id,this.user=this.$injector.get("user"),this.task=this.user.getTaskByType(n),this.result=this.user.getPendingByType(n)};o.$inject=["$scope","$element","$attrs","$injector"],o.prototype.user=null,o.prototype.task=null,o.prototype.result=null,o.prototype.resolved=!1,o.prototype.currentExercise=1,o.prototype.correctAnswers=null,o.prototype.exercise1Answer=null,o.prototype.exercise2Answer=null,o.prototype.exercise1Correct=!1,o.prototype.exercise2Correct=!1,o.prototype.exercise1Result=null,o.prototype.exercise2Result=null,o.prototype.amount=1e3,o.prototype.rate=.01,o.prototype.years=1,o.prototype.domId=null,o.prototype.$onInit=function(){this.init()},o.prototype.getPayload=function(){var t={task:this.task,json:{exercise1:{currentResult:this.exercise1Result,actualResult:this.exercise1Answer,isValid:this.exercise1Correct},exercise2:{currentResult:this.exercise2Result,actualResult:this.exercise2Answer,isValid:this.exercise2Correct},currentExercise:this.currentExercise+1},isPending:this._isPending()};return null!==this.result&&(t=e.extend(this.result,t)),t},o.prototype.isLocked=function(){return null!==this.task&&!this.task.isActive},o.prototype.canResolve=function(){var t=this.$injector.get("user");return!!t.isUser()&&(!this.isLocked()&&(!this.resolved&&(!(1===this.currentExercise&&!this.exercise1Answer)&&!(2===this.currentExercise&&!this.exercise2Answer))))},o.prototype.init=function(){if(null!==this.result){var t=this.result.json;this.exercise1Answer=t.exercise1.actualResult,this.currentExercise=t.currentExercise}this.resolved=!1,this.exercise1Result=this._calculateResult(1),this.exercise2Result=this._calculateResult(1+this.years),this._setCorrectAnswers()},o.prototype.reset=function(){this.init()},o.prototype.update=function(){var t=this,e=function(){t.currentExercise++},o=function(){};this.resolve().then(e,o)},o.prototype.resolve=function(){var t=this.$injector.get("$q");if(!this.canResolve()){var e=t.defer();return e.reject(),e.promise}var o=null===this.result?this.onResolve:this.onUpdate,i=this.getPayload(),n=o({payload:i}),s=this,r=function(t){return t.isPending?void(s.result=t):void(s.resolved=!0)},a=function(){},c=t.when(n);return c.then(r,a),c},o.prototype.setResult=function(t,e){switch(e){case"exercise1":this.exercise1Answer=t||null;break;case"exercise2":this.exercise2Answer=t||null}this._setCorrectAnswers()},o.prototype._isPending=function(){return null===this.exercise2Answer},o.prototype._setCorrectAnswers=function(){this.exercise1Correct=this.exercise1Answer===this.exercise1Result,this.exercise2Correct=this.exercise2Answer===this.exercise2Result,this.exercise1Correct&&this.exercise2Correct?this.correctAnswers=2:this.exercise1Correct?this.correctAnswers=1:this.exercise2Correct?this.correctAnswers=1:this.correctAnswers=0},o.prototype._calculateResult=function(t){return this.amount*Math.pow(1+this.rate,t||1)},e.module(t).directive("interestTask",function(){return{scope:{rate:"=?interestTaskRate",years:"=?interestTaskYears",amount:"=?interestTaskAmount",onUpdate:"&interestTaskOnUpdate",onResolve:"&interestTaskOnResolve"},restrict:"A",transclude:!0,bindToController:!0,controller:o,controllerAs:"interestTaskController",templateUrl:"views/directives/tasks/interest-task.html"}});var i=function(t,e,o){this.$element=e,this.$scope=t,this.$attrs=o,this.disabled=!1,this.stack=[],this.sum=0;var i=this;this._unwatch=t.$watch(function(){return i.sum},function(t){t||(i.sum=0,i.stack=[])})};i.$inject=["$scope","$element","$attrs"],i.prototype.disabled=!1,i.prototype.stack=[],i.prototype.sum=0,i.prototype.notes=[500,200,100,50,20,10,5],i.prototype.coins=[2,1,.5,.2,.1,.05,.02,.01],i.prototype.$onDestroy=function(){this._unwatch()},i.prototype.onDrop=function(t){this.stack.push(t),this.sum+=t,this.onUpdate({sum:this.sum})},i.prototype.revert=function(){this.sum-=this.stack.pop(),this.onUpdate({sum:this.sum})},e.module(t).directive("interestTaskExercise",function(){return{scope:{sum:"=?interestTaskExerciseSum",onUpdate:"&interestTaskExerciseOnUpdate",disabled:"=?interestTaskExerciseDisabled"},restrict:"A",transclude:!0,bindToController:!0,controller:i,controllerAs:"interestTaskExerciseController",templateUrl:"views/directives/tasks/interest-task-exercise.html"}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i){var n=i.get("TYPE_DIVERSIFICATION"),s=i.get("user");this.$injector=i,this.task=s.getTaskByType(n)};o.$inject=["$scope","$element","$attrs","$injector"],o.prototype.task=null,o.prototype.resolved=!1,o.prototype.heads="K",o.prototype.tails="Z",o.prototype.companies={},o.prototype.tickets={},o.prototype.sides=[],o.prototype.$onInit=function(){this.init()},o.prototype.getPayload=function(){return{task:this.task,json:{tickets:{one:this.tickets.one.company,two:this.tickets.two.company},"throws":{one:this["throws"].one.toss,two:this["throws"].two.toss}},ticketCount:this.getTicketCount()}},o.prototype.isLocked=function(){return null!==this.task&&!this.task.isActive},o.prototype.canResolve=function(){var t=this.$injector.get("user");return!!t.isUser()&&(!this.isLocked()&&(!this.resolved&&(!!this.tickets.one.company&&!!this.tickets.two.company)))},o.prototype.init=function(){var t=this.$injector.get("random");this.sides=[this.heads,this.tails],this["throws"]={one:{id:1,toss:t.pick(this.sides)},two:{id:2,toss:t.pick(this.sides)}},this.tickets={one:{id:1,company:null},two:{id:2,company:null}},this.companies={one:{id:1,count:0,tickets:{},name:"Smart",image:"company-a.svg"},two:{id:2,count:0,tickets:{},name:"Phone",image:"company-b.svg"}},this.resolved=!1},o.prototype.reset=function(){this.init()},o.prototype.update=function(t,e,o){switch(o){case"add":e.tickets[t.id]||(e.tickets[t.id]=t,t.company=e.name,e.count++);break;case"remove":e.tickets[t.id]&&(delete e.tickets[t.id],t.company=null,e.count--)}},o.prototype.resolve=function(){var t=this.$injector.get("$q");if(!this.canResolve()){var e=t.defer();return e.reject(),e.promise}var o=this.onResolve({payload:this.getPayload()}),i=this,n=function(){i.resolved=!0},s=function(){},r=t.when(o);return r.then(n,s),r},o.prototype.getTicketCount=function(){var t=this["throws"].one.toss===this.heads?2:1,e=this["throws"].two.toss===this.heads?2:1,o=this.companies.one.count*t,i=this.companies.two.count*e;return o+i},e.module(t).directive("diversificationTask",function(){return{scope:{onResolve:"&diversificationTaskOnResolve"},restrict:"A",transclude:!0,bindToController:!0,controller:o,controllerAs:"diversificationTaskController",templateUrl:"views/directives/tasks/diversification-task.html"}});var i=function(t,e,o,i){this.$scope=t,this.$attrs=o,this.$element=e,this.$injector=i,this._element=this.$element.find(".coin")};i.$inject=["$scope","$element","$attrs","$injector"],i.prototype.toss=null,i.prototype.sides=[],i.prototype.heads="K",i.prototype.tails="Z",i.prototype.flip=!1,i.prototype.animate=!1,i.prototype.back="back",i.prototype.front="front",i.prototype.startSide="K",i.prototype.startValue=null,i.prototype.$onInit=function(){var t=this.$injector.get("animation"),o=this.$injector.get("$timeout"),i=this;
this.sides=[{value:this.heads,"class":this.front,text:this.heads},{value:this.tails,"class":this.back,text:this.tails}],this.startSide!==this.heads&&(this.sides[0]["class"]=this.back,this.sides[1]["class"]=this.front),null!==this.startValue&&(this.sides[0].text=this.startValue,this.sides[1].text=this.startValue),i._toss=i._getToss();var n=function(){var t=function(t){return t.value===i._toss.value?void(t["class"]=i.front):void(t["class"]=i.back)};e.forEach(i.sides,t)},s=function(t){t&&(i.onStart({toss:i._toss.value}),o(n,100),i.sides[0].text=i.heads,i.sides[1].text=i.tails,i.animate=!0)},r=function(){return i.flip},a=function(t,e){t!==e&&(i._toss=i._getToss())},c=function(){return i.toss},l=function(){i.onFinish({toss:i._toss.value}),i.animate=!1},u=function(){i.$scope.$evalAsync(l)};this.onInit({toss:i._toss.value}),t.animationEndEvent&&this._element.on(t.animationEndEvent,u),this._unwatchFlip=this.$scope.$watch(r,s),this._unwatchToss=this.$scope.$watch(c,a)},i.prototype.$onDestroy=function(){var t=this.$injector.get("animation");this._element.off(t.animationEndEvent),this._unwatchToss(),this._unwatchFlip()},i.prototype._getToss=function(){var t=this.$injector.get("$filter"),e=this.$injector.get("random"),o=e.pick(this.sides);if(null===this.toss)return o;var i=t("filter")(this.sides,{value:this.toss});return 0===i.length?(console.warn("Invalid value for `toss` - using random value!"),o):i[0]},e.module(t).directive("diversificationTaskCoin",function(){return{scope:{toss:"=?diversificationTaskCoinToss",flip:"=?diversificationTaskCoinFlip",onInit:"&diversificationTaskCoinOnInit",onStart:"&diversificationTaskCoinOnStart",onFinish:"&diversificationTaskCoinOnFinish",startSide:"=?diversificationTaskCoinStartSide",startValue:"=?diversificationTaskCoinStartValue"},restrict:"A",transclude:!0,bindToController:!0,controller:i,controllerAs:"diversificationTaskCoinController",templateUrl:"views/directives/tasks/diversification-task-coin.html"}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i){var n=i.get("TYPE_RISK"),s=i.get("user");this.$scope=t,this.$attrs=e,this.$element=o,this.$injector=i,this.task=s.getTaskByType(n)};o.$inject=["$scope","$attrs","$element","$injector"],o.prototype.task=null,o.prototype.started=!1,o.prototype.stopped=!1,o.prototype.hasBomb=!1,o.prototype.resolved=!1,o.prototype.totalBoxes=0,o.prototype.remainingBoxes=0,o.prototype.collectedBoxes=0,o.prototype.avg=12,o.prototype.rows=5,o.prototype.cols=5,o.prototype.interval=1,o.prototype.random=!1,o.prototype.dynamic=!1,o.prototype.$onInit=function(){this.init()},o.prototype.getPayload=function(){return{task:this.task,json:{hasBomb:this.hasBomb,collectedBoxes:this.collectedBoxes},ticketCount:this.getTicketCount()}},o.prototype.isLocked=function(){return null!==this.task&&!this.task.isActive},o.prototype.canResolve=function(){var t=this.$injector.get("user");return!!t.isUser()&&(!this.isLocked()&&(!this.resolved&&(this.dynamic?this.stopped:!!this.collectedBoxes)))},o.prototype.init=function(){this._initMembers(),this._initMatrix(),this._initBomb(),this.dynamic||this.start()},o.prototype.reset=function(){this.init()},o.prototype.start=function(t){if(this.dynamic){var e=this.$injector.get("$interval");this._intIndex=t||0;var o=this,i=this.iterator.length;this._intervalId=e(function(){var t=o.iterator[o._intIndex];o.update(t,!0),o._intIndex++,o._intIndex===i&&o.stop()},1e3*this.interval,i-this._intIndex)}this.started=!0},o.prototype.stop=function(){if(this.dynamic&&this._intervalId){var t=this.$injector.get("$interval");t.cancel(this._intervalId)}this.stopped=!0},o.prototype.resolve=function(){var t=this.$injector.get("$q");if(!this.canResolve()){var o=t.defer();return o.reject(),o.promise}var i=this.onResolve({payload:this.getPayload()}),n=function(t){t.$$resolved=!0},s=this,r=function(){e.forEach(s.collection,n),s.resolved=!0},a=function(){},c=t.when(i);return c.then(r,a),c},o.prototype.getTicketCount=function(){return this.hasBomb?1:this.collectedBoxes},o.prototype.toggle=function(t,e){var o=this.collection.indexOf(t);e?(o<0&&(this.collection.push(t),this.collectedBoxes++),t.$$active=!0):o>=0&&(this.collection.splice(o,1),t.$$active=!1,this.collectedBoxes--),this.isBomb(t)&&(this.hasBomb=!0);var i=this.totalBoxes,n=this.collectedBoxes;this.remainingBoxes=i-n},o.prototype.trackId=function(t){return t.row+"_"+t.col},o.prototype.isBomb=function(t){return e.equals(this.bomb,t)},o.prototype._initMembers=function(){this.collection=[],this.hasBomb=!1,this.started=!1,this.stopped=!1,this.resolved=!1,this.collectedBoxes=0,this.remainingBoxes=0,this.totalBoxes=this.rows*this.cols},o.prototype._initMatrix=function(){this.matrix=[],this.iterator=[];for(var t=0;t<this.rows;t++){for(var e=[],o=0;o<this.cols;o++){var i={row:t+1,col:o+1};if(e.push(i),this.dynamic)if(this.random){var n=this.$injector.get("random");n.push(this.iterator,i)}else this.iterator.push(i)}this.matrix.push(e)}},o.prototype._initBomb=function(){var t=this.$injector.get("random"),e=t.between(0,this.rows-1),o=t.between(0,this.cols-1);this.bomb=this.matrix[e][o]},e.module(t).directive("bombTask",function(){return{scope:{avg:"=?bombTaskAvg",rows:"=?bombTaskRows",cols:"=?bombTaskCols",random:"=?bombTaskRandom",dynamic:"=?bombTaskDynamic",interval:"=?bombTaskInterval",onResolve:"&bombTaskOnResolve"},restrict:"A",transclude:!0,controller:o,bindToController:!0,controllerAs:"bombTaskController",templateUrl:"views/directives/tasks/bomb-task.html"}});var i=function(){};i.prototype.model=null,i.prototype.isActive=!1,i.prototype.isDisabled=!1,i.prototype.isClickable=!0,i.prototype.toggle=function(){!this.isDisabled&&this.isClickable&&(this.isActive=!this.isActive,this.onToggle({model:this.model,state:this.isActive}))},e.module(t).directive("bombTaskCard",function(){return{scope:{model:"=bombTaskCard",onToggle:"&bombTaskCardOnToggle",isActive:"=?bombTaskCardIsActive",isDisabled:"=?bombTaskCardIsDisabled",isClickable:"=?bombTaskCardIsClickable"},restrict:"A",transclude:!0,controller:i,bindToController:!0,controllerAs:"bombTaskCardController",templateUrl:"views/directives/tasks/bomb-task-card.html"}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i){var n=i.get("TYPE_ANCHORING"),s=i.get("user");this.$scope=t,this.$attrs=o,this.$element=e,this.$injector=i,this.task=s.getTaskByType(n),this.group=s.getGroupAsString()};o.$inject=["$scope","$element","$attrs","$injector"],o.prototype.task=null,o.prototype.choice=null,o.prototype.group=!1,o.prototype.resolved=!1,o.prototype.$onInit=function(){this.init()},o.prototype.getPayload=function(){var t=this.$injector.get("user");return{task:this.task,json:{group:t.group,choice:this.choice}}},o.prototype.isLocked=function(){return null!==this.task&&!this.task.isActive},o.prototype.canResolve=function(){var t=this.$injector.get("user");return!!t.isUser()&&(!this.isLocked()&&(!this.resolved&&!!this.choice))},o.prototype.init=function(){this.resolved=!1},o.prototype.reset=function(){this.init()},o.prototype.update=function(t,e){this.choice=e?t:null},o.prototype.resolve=function(){var t=this.$injector.get("$q");if(!this.canResolve()){var e=t.defer();return e.reject(),e.promise}var o=this.onResolve({payload:this.getPayload()}),i=this,n=function(){i.resolved=!0},s=function(){},r=t.when(o);return r.then(n,s),r},e.module(t).directive("anchoringTask",function(){return{scope:{onResolve:"&anchoringTaskOnResolve"},restrict:"A",transclude:!0,bindToController:!0,controller:o,controllerAs:"anchoringTaskController",templateUrl:"views/directives/tasks/anchoring-task.html"}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i){var n=i.get("TYPE_MENTAL_BOOKKEEPING"),s=i.get("user");this.$scope=t,this.$attrs=o,this.$element=e,this.$injector=i,this.task=s.getTaskByType(n),this.group=s.getGroupAsString()};o.$inject=["$scope","$element","$attrs","$injector"],o.prototype.task=null,o.prototype.choice=null,o.prototype.group=!1,o.prototype.resolved=!1,o.prototype.$onInit=function(){this.init()},o.prototype.getPayload=function(){var t=this.$injector.get("user");return{task:this.task,json:{group:t.group,choice:this.choice}}},o.prototype.isLocked=function(){return null!==this.task&&!this.task.isActive},o.prototype.canResolve=function(){var t=this.$injector.get("user");return!!t.isUser()&&(!this.isLocked()&&(!this.resolved&&!!this.choice))},o.prototype.init=function(){this.resolved=!1},o.prototype.reset=function(){this.init()},o.prototype.update=function(t,e){this.choice=e?t:null},o.prototype.resolve=function(){var t=this.$injector.get("$q");if(!this.canResolve()){var e=t.defer();return e.reject(),e.promise}var o=this.onResolve({payload:this.getPayload()}),i=this,n=function(){i.resolved=!0},s=function(){},r=t.when(o);return r.then(n,s),r},e.module(t).directive("mentalBookkeepingTask",function(){return{scope:{onResolve:"&mentalBookkeepingTaskOnResolve"},restrict:"A",transclude:!0,bindToController:!0,controller:o,controllerAs:"mentalBookkeepingTaskController",templateUrl:"views/directives/tasks/mental-bookkeeping-task.html"}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i){var n=i.get("TYPE_FRAMING"),s=i.get("user");this.$injector=i,this.task=s.getTaskByType(n)};o.$inject=["$scope","$element","$attrs","$injector"],o.prototype.task=null,o.prototype.resolved=!1,o.prototype.lotteryA=null,o.prototype.lotteryB=null,o.prototype.$onInit=function(){this.init()},o.prototype.getPayload=function(){return{task:this.task,json:{lotteryA:this.lotteryA,lotteryB:this.lotteryB}}},o.prototype.isLocked=function(){return null!==this.task&&!this.task.isActive},o.prototype.canResolve=function(){var t=this.$injector.get("user");return!!t.isUser()&&(!this.isLocked()&&(!this.resolved&&(null!==this.lotteryA&&null!==this.lotteryB)))},o.prototype.init=function(){this.lotteryA=null,this.lotteryB=null,this.resolved=!1},o.prototype.reset=function(){this.init()},o.prototype.update=function(t,e){this[t]=e},o.prototype.resolve=function(){var t=this.$injector.get("$q");if(!this.canResolve()){var e=t.defer();return e.reject(),e.promise}var o=this.onResolve({payload:this.getPayload()}),i=this,n=function(){i.resolved=!0},s=function(){},r=t.when(o);return r.then(n,s),r},e.module(t).directive("framingTask",function(){return{scope:{onResolve:"&framingTaskOnResolve"},restrict:"A",transclude:!0,bindToController:!0,controller:o,controllerAs:"framingTaskController",templateUrl:"views/directives/tasks/framing-task.html"}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i){var n=i.get("TYPE_SAVINGS_TARGET"),s=i.get("user");this.$attrs=o,this.$scope=t,this.$element=e,this.$injector=i,this.task=s.getTaskByType(n)};o.$inject=["$scope","$element","$attrs","$injector"],o.prototype.task=null,o.prototype.wish=null,o.prototype.amount=null,o.prototype.resolved=!1,o.prototype.form=null,o.prototype.minAmount=1,o.prototype.maxAmount=999,o.prototype.$onInit=function(){this.init()},o.prototype.getPayload=function(){return{task:this.task,json:{wish:this.wish,amount:this.amount}}},o.prototype.isLocked=function(){return null!==this.task&&!this.task.isActive},o.prototype.canResolve=function(){var t=this.$injector.get("user");return!!t.isUser()&&(!this.isLocked()&&(!this.resolved&&!this.form.$invalid))},o.prototype.init=function(){this.wish=null,this.amount=null,this.resolved=!1},o.prototype.reset=function(){this.init()},o.prototype.update=function(){},o.prototype.resolve=function(){var t=this.$injector.get("$q");if(!this.canResolve()){var e=t.defer();return e.reject(),e.promise}var o=this.onResolve({payload:this.getPayload()}),i=this,n=function(){i.resolved=!0},s=function(){},r=t.when(o);return r.then(n,s),r},e.module(t).directive("savingsTargetTask",function(){return{scope:{onResolve:"&savingsTargetTaskOnResolve"},restrict:"A",transclude:!0,bindToController:!0,controller:o,controllerAs:"savingsTargetTaskController",templateUrl:"views/directives/tasks/savings-target-task.html"}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i){var n=i.get("TYPE_SAVINGS_SUPPORTED"),s=i.get("user");this.$scope=t,this.$attrs=o,this.$element=e,this.$injector=i,this.task=s.getTaskByType(n)};o.$inject=["$scope","$element","$attrs","$injector"],o.prototype.task=null,o.prototype.choice=null,o.prototype.resolved=!1,o.prototype.$onInit=function(){this.init()},o.prototype.getPayload=function(){return{task:this.task,json:{choice:this.choice}}},o.prototype.isLocked=function(){return null!==this.task&&!this.task.isActive},o.prototype.canResolve=function(){var t=this.$injector.get("user");return!!t.isUser()&&(!this.isLocked()&&(!this.resolved&&!!this.choice))},o.prototype.init=function(){this.resolved=!1},o.prototype.reset=function(){this.init()},o.prototype.update=function(t,e){this.choice=e?t:null},o.prototype.resolve=function(){var t=this.$injector.get("$q");if(!this.canResolve()){var e=t.defer();return e.reject(),e.promise}var o=this.onResolve({payload:this.getPayload()}),i=this,n=function(){i.resolved=!0},s=function(){},r=t.when(o);return r.then(n,s),r},e.module(t).directive("savingsSupportedTask",function(){return{scope:{onResolve:"&savingsSupportedTaskOnResolve"},restrict:"A",transclude:!0,bindToController:!0,controller:o,controllerAs:"savingsSupportedTaskController",templateUrl:"views/directives/tasks/savings-supported-task.html"}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i){var n=i.get("TYPE_SELF_COMMITMENT");this.$injector=i,this.user=this.$injector.get("user"),this.task=this.user.getTaskByType(n),this.result=this.user.getPendingByType(n)};o.$inject=["$scope","$element","$attrs","$injector"],o.prototype.user=null,o.prototype.task=null,o.prototype.result=null,o.prototype.videos={"XkuPL-tgFxw":!1},o.prototype.resolved=!1,o.prototype.$onInit=function(){this.init()},o.prototype.getPayload=function(){var t={task:this.task,json:{videos:this.videos},isPending:this._isPending()};return null!==this.result&&(t=e.extend(this.result,t)),t},o.prototype.isLocked=function(){return!!this.user.isUser()&&!this.task.isActive},o.prototype.canResolve=function(){var t=this.$injector.get("user");return!!t.isUser()&&(!this.isLocked()&&!this.resolved)},o.prototype.init=function(){if(null!==this.result){var t=this.result.json;this.videos=t.videos}this.resolved=!1},o.prototype.reset=function(){this.init()},o.prototype.update=function(t){if(!this.videos[t]){this.videos[t]=!0;var e=this,o=function(){},i=function(){e.videos[t]=!1};this.resolve().then(o,i)}},o.prototype.resolve=function(){var t=this.$injector.get("$q");if(!this.canResolve()){var e=t.defer();return e.reject(),e.promise}var o=null===this.result?this.onResolve:this.onUpdate,i=this.getPayload(),n=o({payload:i}),s=this,r=function(t){return t.isPending?void(s.result=t):void(s.resolved=!0)},a=function(){},c=t.when(n);return c.then(r,a),c},o.prototype._isPending=function(){for(var t in this.videos)if(!this.videos[t])return!0;return!1},e.module(t).directive("selfCommitmentTask",function(){return{scope:{onUpdate:"&selfCommitmentTaskOnUpdate",onResolve:"&selfCommitmentTaskOnResolve"},restrict:"A",transclude:!0,bindToController:!0,controller:o,controllerAs:"selfCommitmentTaskController",templateUrl:"views/directives/tasks/self-commitment-task.html"}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o,i){var n=i.get("TYPE_PROCRASTINATION"),s=i.get("user");this.$injector=i,this.task=s.getTaskByType(n),this.result=s.getPendingByType(n),this.domId="procrastination-task-"+t.$id,this._intervalId=null,this._onInterval=this._onInterval.bind(this)};o.$inject=["$scope","$element","$attrs","$injector"],o.prototype.type=null,o.prototype.task=null,o.prototype.result=null,o.prototype.mode=null,o.prototype.count=0,o.prototype.total=1,o.prototype.rounds=[],o.prototype.openRounds=null,o.prototype.minCatched=null,o.prototype.maxEscaped=null,o.prototype.updatedAt=null,o.prototype.invalidAt=null,o.prototype.state="IDLE",o.prototype.resolved=!1,o.prototype.domId=null,o.prototype.hasWarmup=!1,o.prototype.warmupMaxEscaped=2,o.prototype.warmupMinCatched=20,o.prototype.$onInit=function(){this.init()},o.prototype.$onDestroy=function(){var t=this.$injector.get("$interval");null!==this._intervalId&&t.cancel(this._intervalId)},o.prototype.getPayload=function(){var t={task:this.task,json:{mode:this.mode,state:this.state,rounds:this.rounds,success:this.hasSuccess()},isPending:this._isPending(),ticketCount:this.getTicketCount()};return null!==this.result&&(t=e.extend(this.result,t)),t},o.prototype.isLocked=function(){return null!==this.task&&!this.task.isActive},o.prototype.canResolve=function(){var t=this.$injector.get("user");return!!t.isUser()&&(!this.isLocked()&&(!!this.hasWarmup&&!this.resolved))},o.prototype.init=function(){if(null!==this.result){var t=this.result.json;this.rounds=t.rounds,this.count=t.rounds.length,this.setWarmup(!0),this.setMode(t.mode),this.setState(t.state)}this.resolved=!1},o.prototype.reset=function(){this.init()},o.prototype.update=function(t){var e=this.state,o=this.count;switch(this.state){case"IDLE":this.setState("DECISION");break;case"DECISION":this.setState("PLAYING");break;case"PLAYING":this.count=this.rounds.push(t)}var i=this,n=function(){},s=function(){i.setState(e),i.count=o};this.resolve().then(n,s)},o.prototype.resolve=function(){var t=this.$injector.get("notification"),e=this.$injector.get("i18n"),o=this.$injector.get("$q");if(!this.canResolve()){var i=o.defer();return i.reject(),i.promise}var n=null===this.result?this.onResolve:this.onUpdate,s=n({payload:this.getPayload()}),r=this,a=function(o){var i;if(o.isPending)switch(r.result=o,r.state){case"IDLE":break;case"DECISION":break;case"PLAYING":switch(r.mode){case"ALL":break;case"SPLIT":r.count>0&&(i=e.get("Super, you have succeeded exercise %s of %s!",r.count,r.total),t.success(i))}}else r.hasSuccess()?(i=e.get("Super, you have successfully done this exercise and retrieve 5 tickets!"),t.success(i)):(i=e.get("Sorry, but the time has expired for this exercise and you retrieve only 1 ticket!"),t.error(i)),r.resolved=!0},c=function(){},l=o.when(s);return l.then(a,c),l},o.prototype.setMode=function(t){switch(t){case"ALL":this.total=1,this.maxEscaped=15,this.minCatched=150;break;case"SPLIT":this.total=3,this.maxEscaped=5,this.minCatched=50;break;default:return}this.mode=t,this.openRounds=this.total-this.count},o.prototype.setState=function(t){var e=this.$injector.get("$interval");switch(t){case"IDLE":break;case"DECISION":break;case"PLAYING":var o=this.result.updatedAt;switch(this.updatedAt=moment.unix(o),this.invalidAt=this.updatedAt.clone(),this.mode){case"ALL":this.invalidAt.add(6,"weeks");break;case"SPLIT":this.invalidAt.add(2,"weeks")}this._intervalId=e(this._onInterval,1e3);break;default:return}this.state=t},o.prototype.setWarmup=function(t){this.hasWarmup=t},o.prototype.isInvalid=function(){return null!==this.invalidAt&&+this._now()>+this.invalidAt},o.prototype.hasSuccess=function(){return this.rounds.length===this.total},o.prototype.getCurrentRound=function(){return this.count+1},o.prototype.getRemainingTime=function(){var t=this.$injector.get("string"),e=this.$injector.get("i18n");if(null===this.invalidAt)return"";var o,i,n=this.invalidAt.diff(this._now()),s=moment.duration(n),r=~~s.asSeconds(),a=~~s.asMinutes(),c=~~s.asHours(),l=~~s.asDays();l>0?(o=l,i=["day","days"]):c>0?(o=c,i=["hour","hours"]):a>0?(o=a,i=["minute","minutes"]):(o=r>=0?r:0,i=["second","seconds"]);var u=1===o?i[0]:i[1],h=e.get(u);return t.sprintf("%s %s",o,h)},o.prototype.getTicketCount=function(){return this.hasSuccess()?5:1},o.prototype._onInterval=function(){var t=this.$injector.get("$interval");this.isInvalid()&&this.canResolve()&&(t.cancel(this._intervalId),this.count=this.total,this.resolve())},o.prototype._isPending=function(){return this.count<this.total},o.prototype._now=function(){return moment()},e.module(t).directive("procrastinationTask",function(){return{scope:{onUpdate:"&procrastinationTaskOnUpdate",onResolve:"&procrastinationTaskOnResolve"},restrict:"A",transclude:!0,bindToController:!0,controller:o,controllerAs:"procrastinationTaskController",templateUrl:"views/directives/tasks/procrastination-task.html"}});var i=function(t,o,i,n){this.$scope=t,this.$attrs=i,this.$element=o,this.$injector=n,this.bubbles={},this.viewport={},this.domId="viewport-"+t.$id,this._nextId=0,this._tapped=0,this._rounds=0,this._retries=0,this._timeout=100,this._requestId=null,this._loop=this._loop.bind(this),this._update=this._update.bind(this),this._resize=this._resize.bind(this),this._window=e.element(window),this._viewport=this.$element.find(".viewport")};i.$inject=["$scope","$element","$attrs","$injector"],i.prototype.catched=0,i.prototype.escaped=0,i.prototype.accuracy=0,i.prototype.bubbles=null,i.prototype.viewport=null,i.prototype.state="IDLE",i.prototype.expired=!1,i.prototype.maxRounds=1,i.prototype.maxRetries=Number.POSITIVE_INFINITY,i.prototype.maxEscaped=15,i.prototype.minCatched=150,i.prototype.bubbleDelay=100,i.prototype.$onInit=function(){this._window.on("resize",this._resize);var t=this;this._unwatch=this.$scope.$watch(function(){return t.expired},function(e){e&&t.expire()})},i.prototype.$onDestroy=function(){this._window.off("resize",this._resize),this._unwatch(),this._unloop()},i.prototype.start=function(){this.viewport=this._getViewport(),this.state="RUNNING",this._loop()},i.prototype.quit=function(){this._unloop(),this._retries++,this.bubbles={},this.state="GAME_OVER";var t=this._getResult();this.onGameOver({result:t})},i.prototype.done=function(){this._unloop(),this._rounds++,this.bubbles={},this.state="GAME_DONE";var t=this._getResult();this.onGameDone({result:t})},i.prototype.expire=function(){this._unloop(),this.bubbles={},this.state="TIMEOUT"},i.prototype.reset=function(){this._unloop(),this._nextId=0,this._tapped=0,this._timeout=100,this._requestId=null,this.catched=0,this.escaped=0,this.accuracy=0,this.state="IDLE"},i.prototype.onClick=function(t){switch(this.state){case"IDLE":this.start();break;case"RUNNING":this._tapped++;var e=t.target,o=this._viewport.get(0);o.id===e.id&&this._setAccuracy();break;case"TIMEOUT":break;case"GAME_OVER":this.canRetry()&&(this.reset(),this.start());break;case"GAME_DONE":this.canRestart()&&(this.reset(),this.start())}},i.prototype.canRetry=function(){return this._retries<this.maxRetries},i.prototype.canRestart=function(){return this._rounds<this.maxRounds},i.prototype.addBubble=function(t){this.bubbles[t.id]=t},i.prototype.removeBubble=function(t){if(this.bubbles[t.id]){if(t.catched){this.catched++,this._setAccuracy();var e=this.minCatched;this.catched>=e&&this.done()}if(t.escaped){this.escaped++;var o=this.maxEscaped;this.escaped>o&&this.quit()}delete this.bubbles[t.id]}},i.prototype._loop=function(){var t=this.$injector.get("animation");this._requestId=t.requestAnimationFrame(this._loop),this.$scope.$evalAsync(this._update)},i.prototype._unloop=function(){var t=this.$injector.get("animation");t.cancelAnimationFrame(this._requestId)},i.prototype._update=function(){var t=this.$injector.get("random");this._timeout--,0===this._timeout&&(this._timeout=t.between(0,this.bubbleDelay)+25,this.bubbles[this._nextId++]=null);for(var e in this.bubbles){var o=this.bubbles[e];o&&o.update()}},i.prototype._resize=function(){this.viewport=this._getViewport();var t=this.viewport.height,e=this.viewport.width;this.ratio=e/t;for(var o in this.bubbles){var i=this.bubbles[o];i&&i.resize()}},i.prototype._getResult=function(){return{catched:this.catched,escaped:this.escaped,accuracy:this.accuracy}},i.prototype._setAccuracy=function(){this.accuracy=this.catched/this._tapped},i.prototype._getViewport=function(){var t=this._viewport.width(),e=this._viewport.height(),o=this._viewport.scrollTop(),i=this._viewport.scrollLeft();return{top:o,left:i,width:t,height:e,right:i+t,bottom:o+e}},e.module(t).directive("procrastinationTaskGame",function(){return{scope:{expired:"=?procrastinationTaskGameExpired",maxRounds:"=?procrastinationTaskGameMaxRounds",maxRetries:"=?procrastinationTaskGameMaxRetries",onGameDone:"&procrastinationTaskGameOnGameDone",onGameOver:"&procrastinationTaskGameOnGameOver",minCatched:"=?procrastinationTaskGameMinCatched",maxEscaped:"=?procrastinationTaskGameMaxEscaped",bubbleDelay:"=?procrastinationTaskGameBubbleDelay"},restrict:"A",transclude:!0,bindToController:!0,controller:i,controllerAs:"procrastinationTaskGameController",templateUrl:"views/directives/tasks/procrastination-task-game.html"}});var n=function(t,e,o,i){this.$scope=t,this.$attrs=o,this.$element=e,this.$injector=i,this.domId="bubble-"+t.$id};n.$inject=["$scope","$element","$attrs","$injector"],n.prototype.themes=["theme-1","theme-2","theme-3","theme-4","theme-5"],n.prototype["class"]="bubble",n.prototype.style={},n.prototype.theme=null,n.prototype.radius=null,n.prototype.speed=null,n.prototype.wave=null,n.prototype.x=null,n.prototype.y=null,n.prototype.$onInit=function(){var t=this.$injector.get("random"),e=this.gameController;this.theme=t.pick(this.themes),this.radius=t.between(0,15)+20,this.speed=t.between(0,1.25)+2.25,this.wave=1.5+this.radius;var o=2*this.radius;this.y=e.viewport.height+t.between(0,50)+50,this.x=t.between(o,e.viewport.width-o),this._originalR=e.ratio,this._originalX=this.x,this.style={top:this.y,left:this.x,width:2*this.radius,height:2*this.radius},this.gameController.addBubble(this)},n.prototype.$onDestroy=function(){this.gameController.removeBubble(this)},n.prototype.update=function(){var t=Math.sin(.002*(new Date).getTime());this.x=this.wave*t+this._originalX,this.y=this.y-this.speed,this.style.left=this.x,this.style.top=this.y;var e=2*-this.radius;this.y>e||(this.escaped=!0,this.gameController.removeBubble(this))},n.prototype.resize=function(){var t=this.$injector.get("$timeout"),e=this,o=function(){var t=e.gameController.ratio,o=t/e._originalR;e._originalX*=o,e._resizeId=null};this._resizeId&&t.cancel(this._resizeId),this._resizeId=t(o,250)},n.prototype.onClick=function(){var t=this.$injector.get("animation"),e=this.$injector.get("$timeout"),o=this,i=function(){o.gameController.removeBubble(o)},n=function(){o.$scope.$evalAsync(i),o.$element.off(t.animationEndEvent,n)};t.animationEndEvent?this.$element.on(t.animationEndEvent,n):e(i,50),this.catched=!0},e.module(t).directive("procrastinationTaskBubble",function(){return{scope:{id:"=procrastinationTaskBubble"},restrict:"A",transclude:!0,bindToController:!0,controller:n,require:{gameController:"^procrastinationTaskGame"},controllerAs:"procrastinationTaskBubbleController",templateUrl:"views/directives/tasks/procrastination-task-bubble.html"}})}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o){this.$injector=e,this.$scope=t,this.code=o};o.$inject=["$scope","$injector","code"],o.prototype.code=null,o.prototype.username=null,o.prototype.codeMinLength=8,o.prototype.codePattern=/^[A-Za-z0-9]+$/,o.prototype.userpattern=/^[A-Za-z][A-Za-z](?:0[1-9]|[12]\d|3[01])(?:0[1-9]|1[012])\d$/,o.prototype.signin=function(){var t=this.$injector.get("notification"),e=this.$injector.get("$timeout"),o=this.$injector.get("$state"),i=this.$injector.get("auth"),n=this.$injector.get("i18n"),s=this.$scope.loginForm;if(!s.$invalid){var r=function(){var i=n.get("You have successfully signed in!");t.success(i),e(function(){o.go("frontend")})},a=function(){};i.signin({username:this.username},"frontend").then(r,a)}},o.prototype.signup=function(){var t=this.$injector.get("notification"),e=this.$injector.get("$timeout"),o=this.$injector.get("$state"),i=this.$injector.get("auth"),n=this.$injector.get("i18n"),s=this.$scope.loginForm;if(!s.$invalid){var r=function(){var i=n.get("You have successfully signed up!");t.success(i),e(function(){o.go("frontend")})},a=function(){};i.signup({username:this.username,password:this.code},"frontend").then(r,a)}},o.prototype.next=function(){var t=this.$injector.get("CODE_STORAGE_KEY"),e=this.$injector.get("storage").getProxy(),o=this.$injector.get("$state");e.setItem(t,this.code),o.go("login.frontend.signup.step2",{},{reload:!0})},e.module(t).controller("LoginFrontendController",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e){this.$injector=e,this.$scope=t};o.$inject=["$scope","$injector"],o.prototype.username=null,o.prototype.password=null,o.prototype.usernameMinLength=5,o.prototype.passwordMinLength=8,o.prototype.passwordMaxLength=4096,o.prototype.signin=function(){var t=this.$injector.get("notification"),e=this.$injector.get("$timeout"),o=this.$injector.get("$state"),i=this.$injector.get("auth"),n=this.$injector.get("i18n"),s=this.$scope.loginForm;if(!s.$invalid){var r=function(){var i=n.get("You are logged in now!");t.success(i),e(function(){o.go("backend")})},a=function(){};i.signin({username:this.username,password:this.password},"backend").then(r,a)}},e.module(t).controller("LoginBackendController",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e){this.$injector=e,this.$scope=t};o.$inject=["$scope","$injector"],o.prototype.name=null,o.prototype.email=null,o.prototype.subject=null,o.prototype.message=null,o.prototype.messageMinLength=25,o.prototype.submit=function(){var t=this.$injector.get("mail"),e=this.$scope.contactForm;if(!e.$invalid){var o=this,i=function(){o.reset()},n=function(){};t.send({name:this.name,email:this.email,subject:this.subject,message:this.message}).then(i,n)}},o.prototype.reset=function(){this.name=null,this.email=null,this.subject=null,this.message=null},e.module(t).controller("ContactController",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t){this.$injector=t,this.user=t.get("user")};o.$inject=["$injector"],o.prototype.user=null,o.prototype.confirmLogout=!1,o.prototype.createResult=function(t){var e=this.$injector.get("Result"),o=this.$injector.get("user"),i=function(t){o.update(t)},n=function(){},s=new e(t),r=s.$create();return r.then(i,n),r},o.prototype.updateResult=function(t){var e=this.$injector.get("Result"),o=this.$injector.get("user"),i=function(t){o.update(t)},n=function(){},s=e.update({id:t.id},t).$promise;return s.then(i,n),s},o.prototype.logout=function(){var t=this.$injector.get("$timeout"),e=this.$injector.get("$state"),o=this.$injector.get("auth"),i=this.user.isUser(),n=function(){t(function(){i?e.go("login.frontend"):e.go("login.backend")})},s=function(){};o.signout().then(n,s)},o.prototype.goTo=function(t){var e=this.$injector.get("$state");e.go(t)},o.prototype.markConfirmLogout=function(){this.confirmLogout=!0},e.module(t).controller("FrontendController",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o){this.workshops=o,this.$injector=e,this.$scope=t,this._resultsSource=null,this._userSources={},this._workshops={},this._tasks={},this._initWorkshops(),this._initListener()};o.$inject=["$scope","$injector","workshops"],o.prototype.name=null,o.prototype.code=null,o.prototype.nameMinLength=8,o.prototype.codeMinLength=8,o.prototype.codePattern=/^[A-Za-z0-9]+$/,o.prototype.deleteWorkshop=null,o.prototype.drawingWorkshop=null,o.prototype.drawingTickets=null,o.prototype.drawingTicketsAll=null,o.prototype.drawingTicketsOne=null,o.prototype.drawingTicketsTwo=null,o.prototype.drawingAmount=2,o.prototype.chartResults=null,o.prototype.chartTask=null,o.prototype.uiOnParamsChanged=function(t){var e=this._workshops[t.expand];this._expanded&&(this._expanded.$$expanded=!1,this._expanded=null),e&&(e.$$expanded=!0,this._expanded=e)},o.prototype.create=function(){var t=this.$injector.get("notification"),e=this.$injector.get("Workshop"),o=this.$injector.get("i18n"),i=new e({name:this.name,code:this.code}),n=this,s=function(e){var i=o.get("Workshop has been created successfully!");t.success(i),n.workshops.unshift(e),n._initWorkshop(e),n.name=null,n.code=null},r=function(){};i.$create().then(s,r)},o.prototype["delete"]=function(t){var e=this.$injector.get("notification"),o=this.$injector.get("i18n"),i=this,n=function(){var n=o.get("Workshop has been deleted successfully!");e.success(n);
var s=i.workshops.indexOf(t);i.workshops.splice(s,1),i._removeUsersStream(t)},s=function(){};t.$delete().then(n,s)},o.prototype.markWorkshopForDrawing=function(t){var e=this.$injector.get("Ticket"),o=this.$injector.get("random"),i=this,n=function(e){i.drawingTicketsAll=e,i.drawingTickets=o.shuffle(i.drawingTicketsAll),i.drawingTickets=i.drawingTickets.slice(Math.max(e.length-20,0));var s={},r=i.drawingTickets.map(function(t){return s[t.id]=t.username,t.id}),a=Math.ceil(i.drawingTickets.length/2),c=r.splice(0,a);i.drawingTicketsOne=c.concat(r),i.drawingTicketsTwo=r.concat(c);var l=i.drawingTicketsOne.length-1,u=i.drawingTicketsTwo.length-1,h=i.drawingTicketsOne[l],p=i.drawingTicketsTwo[u];return i.drawingUserOne=s[h],i.drawingUserTwo=s[p],i.drawingUserOne!==i.drawingUserTwo?void(i.drawingWorkshop=t):void n(e)},s=function(){},r=e.getByWorkshop({workshopId:t.id});r.$promise.then(n,s)},o.prototype.makeWorkshopDrawing=function(){this.drawingWorkshop.$$shuffleOne=!0,this.drawingWorkshop.$$shuffleTwo=!0},o.prototype.resetWorkshopDrawing=function(){this.drawingWorkshop.$$shuffleOne=null,this.drawingWorkshop.$$shuffleTwo=null,this.drawingWorkshop.$$finishedOne=null,this.drawingWorkshop.$$finishedTwo=null},o.prototype.markWorkshopForDeletion=function(t){this.deleteWorkshop=t},o.prototype.toggleWorkshop=function(t){var e=this.$injector.get("notification"),o=this.$injector.get("i18n"),i=this,n=function(t){var n=o.get(t.isActive?"Workshop has been unlocked successfully. Students can register now!":"Workshop has been locked successfully. Students can now only use their access from home!");e.success(n),i._initWorkshop(t)},s=function(){t.isActive=!t.isActive};t.isActive=!t.isActive,t.$update().then(n,s)},o.prototype.toggleCode=function(t){t.$$code=!t.$$code},o.prototype.markTaskForChart=function(t){var e=this.$injector.get("Result"),o=this,i=function(e){o.chartResults=e,o.chartTask=t},n=function(){},s=e.getByTask({taskId:t.id});s.$promise.then(i,n)},o.prototype.toggleTask=function(t){var e=this.$injector.get("notification"),o=this.$injector.get("i18n"),i=this.$injector.get("Task"),n=function(){var i=o.get(t.isActive?"Task has been unlocked successfully. Students can send results now!":"Task has been locked successfully. Students cannot send results currently!");e.success(i)},s=function(){t.isActive=!t.isActive};t.isActive=!t.isActive;var r=i.update({id:t.id},t);r.$promise.then(n,s)},o.prototype.expand=function(t){var e=this.$injector.get("$state"),o=t.$$expanded?null:t.id;e.go("backend.workshops",{expand:o})},o.prototype._addUsersStream=function(t){var e=this.$injector.get("API_URL"),o=this.$injector.get("sse"),i=this,n=function(e){i.$scope.$evalAsync(function(){t.$$users=e})},s=e+"/sse/workshop/"+t.id+"/users",r={onMessage:n,sleep:10},a=o.addSource(s,r);this._userSources[t.id]=a},o.prototype._removeUsersStream=function(t){var e=this.$injector.get("sse"),o=this._userSources[t.id];o&&(delete this._userSources[t.id],e.removeSource(o))},o.prototype._streamResults=function(){var t=this.$injector.get("API_URL"),o=this.$injector.get("sse"),i=this,n=function(t,n){i.$scope.$evalAsync(function(){t.isActive||o.removeSource(i._resultsSource),e.forEach(n,function(t){var e=i._tasks[t.id];e.$$results=t.results})})},s=function(){return i._expanded&&i._expanded.isActive},r=function(){if(i._resultsSource&&o.removeSource(i._resultsSource),i._expanded){var e=t+"/sse/workshop/"+i._expanded.id+"/results",s=n.bind(i,i._expanded),r={onMessage:s,sleep:5};i._resultsSource=o.addSource(e,r)}};this._unwatch=this.$scope.$watch(s,r)},o.prototype._initWorkshops=function(){var t=this.$injector.get("$uiRouterGlobals");e.forEach(this.workshops,this._initWorkshop.bind(this)),this.uiOnParamsChanged(t.params),this._streamResults()},o.prototype._initWorkshop=function(t){var o=this;e.forEach(t.tasks,function(t){var e=o._tasks[t.id]||null;t.$$results=null!==e?e.$$results:0,o._tasks[t.id]=t}),t.$$code=!1;var i=this._expanded&&this._expanded.id;t.$$expanded=t.id===i,t.$$users=t.users.length,t.isActive?this._addUsersStream(t):this._removeUsersStream(t),this._workshops[t.id]=t},o.prototype._initListener=function(){var t=this.$injector.get("sse"),e=this,o=function(){for(var o in e._userSources)t.removeSource(e._userSources[o]);e._resultsSource&&t.removeSource(e._resultsSource),e._resultsSource=null,e._userSources={},e._unlisten(),e._unwatch()};this._unlisten=this.$scope.$on("$destroy",o)},e.module(t).controller("WorkshopController",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o){this.admins=o,this.$injector=e,this.$scope=t};o.$inject=["$scope","$injector","admins"],o.prototype.username=null,o.prototype.password=null,o.prototype.usernameMinLength=5,o.prototype.passwordMinLength=8,o.prototype.editAdmin=null,o.prototype.deleteAdmin=null,o.prototype.create=function(){var t=this.$injector.get("notification"),e=this.$injector.get("Admin"),o=this.$injector.get("i18n"),i=new e({username:this.username,password:this.password}),n=this,s=function(e){var i=o.get("Admin has been created successfully!");t.success(i),n.admins.unshift(e),n.username=null,n.password=null},r=function(){};i.$create().then(s,r)},o.prototype.markAdminForDeletion=function(t){this.deleteAdmin=t},o.prototype["delete"]=function(t){var e=this.$injector.get("notification"),o=this.$injector.get("i18n"),i=this,n=function(){var n=o.get("Admin has been deleted successfully!");e.success(n);var s=i.admins.indexOf(t);i.admins.splice(s,1)},s=function(){};t.$delete().then(n,s)},o.prototype.markAdminForEdit=function(t){this.editAdmin=t},o.prototype.update=function(t){var e=this.$injector.get("notification"),o=this.$injector.get("i18n"),i=function(){var t=o.get("Password has been successfully updated!");e.success(t)},n=function(){};t.$update().then(i,n)},e.module(t).controller("AdminController",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e){this.$injector=t,this.isSuperAdmin=e};o.$inject=["$injector","isSuperAdmin"],o.prototype.isSuperAdmin=!1,o.prototype.confirmLogout=!1,o.prototype.logout=function(){var t=this.$injector.get("$timeout"),e=this.$injector.get("$state"),o=this.$injector.get("auth"),i=function(){t(function(){e.go("login.backend")})},n=function(){};o.signout().then(i,n)},o.prototype.goTo=function(t){var e=this.$injector.get("$state");e.go(t)},o.prototype.markConfirmLogout=function(){this.confirmLogout=!0},e.module(t).controller("BackendController",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e){var o=e+"/workshop/:id",i={id:"@id"},n={validateWorkshopBackend:{method:"GET",skipGlobalErrorMessage:!0,url:e+"/workshop/code/:code"},validateUsernameFrontend:{method:"GET",skipGlobalErrorMessage:!0,url:e+"/auth/validate/username/:username"},validateWorkshopFrontend:{method:"GET",skipGlobalErrorMessage:!0,url:e+"/auth/validate/workshop/:code"}},s={};return t(o,i,n,s)};o.$inject=["$resource","API_URL"],e.module(t).factory("Workshop",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e){var o=e+"/ticket/:id",i={id:"@id"},n={getByWorkshop:{method:"GET",isArray:!0,url:e+"/ticket/workshop/:workshopId"}},s={};return t(o,i,n,s)};o.$inject=["$resource","API_URL"],e.module(t).factory("Ticket",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e,o){var i=o+"/result/:id",n={id:"@id"},s={getByTask:{method:"GET",isArray:!0,url:o+"/result/task/:taskId"}},r={};return t(i,n,s,r)};o.$inject=["$resource","$injector","API_URL"],e.module(t).factory("Result",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e){var o=e+"/admin/:id",i={id:"@id"},n={validateAdmin:{method:"GET",skipGlobalErrorMessage:!0,url:e+"/admin/username/:username"}},s={};return t(o,i,n,s)};o.$inject=["$resource","API_URL"],e.module(t).factory("Admin",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e){var o=e+"/task/:id",i={id:"@id"},n={},s={};return t(o,i,n,s)};o.$inject=["$resource","API_URL"],e.module(t).factory("Task",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";var o=function(t,e){var o=e+"/user/:id",i={id:"@id"},n={current:{method:"GET",skipGlobalErrorMessage:!0,url:e+"/user/current"}},s={};return t(o,i,n,s)};o.$inject=["$resource","API_URL"],e.module(t).factory("User",o)}(ANGULAR_MODULE,angular),function(t,e){"use strict";e.module(t).filter("i18n",["i18n",function(t){var e=function(){return t.get.apply(t,arguments)};return e.$stateful=!0,e}]),e.module(t).filter("percent",function(){return function(t,e){return e=isNaN(e)?0:e,t=isNaN(t)?0:100*t,t.toFixed(e)+"%"}}),e.module(t).filter("coin",function(){return function(t){return t>=1?t+"&#8364;":100*t+"&#162;"}}),e.module(t).filter("note",function(){return function(t){return t+"&#8364;"}})}(ANGULAR_MODULE,angular),function(){"use strict";UIkit.component("off-canvas-scroll",{defaults:{offset:0,target:"",duration:1e3,transition:"easeOutExpo"},props:{target:String,offset:Number,duration:Number,transition:String},computed:{offcanvas:function(){return UIkit.offcanvas(this.target)},$offcanvas:function(){return this.offcanvas&&this.offcanvas.$el}},init:function(){return this.target?this.offcanvas?void 0:void console.error("off-canvas-scroll: No offcanvas component found with id: "+this.target):void console.error('off-canvas-scroll: Required "target" option is not set.')},events:{click:function(t,e){e&&e.scroll||(this.offcanvas.hide(),this.$offcanvas.on("hidden",this._onHidden))}},methods:{_onHidden:function(){this.$offcanvas.off("hidden",this._onHidden),this._dummyScroll=UIkit.scroll(this.$el,{transition:this.transition,duration:this.duration,offset:this.offset}),this.$el.on("scrolled",this._onScrolled),this.$el.trigger("click",{scroll:!0})},_onScrolled:function(){this.$el.off("scrolled",this._onScrolled),this._dummyScroll.$destroy()}}})}();
//# sourceMappingURL=../maps/js/app-48c3934782.min.js.map
